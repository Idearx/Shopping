function showAuthCodeError(e){$("#pc-toast").addClass("input-error-EMUI5"),$("#errorTips").addClass("authCode-errorTips").html(e)}function hideAuthCodeError(){$("#pc-toast").removeClass("input-error-EMUI5"),$("#errorTips").removeClass("authCode-errorTips").html("")}function notifyEnableNextBtn(e){0<e.length?$("#next").hasClass("disabled")&&$("#next").removeClass("disabled"):$("#next").hasClass("disabled")||$("#next").addClass("disabled")}function getAuthCodeBySMS(){var e=$("#getValiCode"),r=$("#pc-toast"),o=$("#errorTips");if("disabled"!=$("#getValiCode").attr("disabled")){var t={accountType:localInfo.verifyAccountType,reqClientType:localInfo.reqClientType,languageCode:localInfo.lang,operType:"24",getCodeButton:e,errorBorder:r,errorClass:"authCode-errorTips",errorTips:o};2==localInfo.verifyAccountType||6==localInfo.verifyAccountType?(t.smsReqType="1",t.successFunction=function(){showMsgSuccess({obj:$("#errorTips"),msg:rss_new.common_sms_has_sendto.format(getExpressPhone(localInfo.verifyUserAccount)),leftPix:"55px",rightPix:"55px",bottom:"42px"})},sendMobileCode(t)):1!=localInfo.verifyAccountType&&5!=localInfo.verifyAccountType||(t.emailReqType="1",t.successFunction=function(){showMsgSuccess({obj:$("#errorTips"),msg:rss_new.common_email_has_sendto.format(getExpressPhone(localInfo.verifyUserAccount)),leftPix:"55px",rightPix:"55px",bottom:"42px"})},sendEmailCode(t))}}function Trim(e){return e.replace(/(^\s*)|(\s*$)/g,"")}function changeRandomCode(){gid("randomCodeImg")&&(gid("randomCodeImg").src=randomCodeImgURL+"&_t="+(new Date).getTime())}function getMobileCode(e,r,o,t,n,s,a,i,c){var l,d;l=Trim(c||$("#phoneaccount").val()),d=Trim(i||$("#username").val());var u=$("#getValiCode"),p=$("#randomCode").val();if(""==p)return changeRandomCode(),void $("#randomCode").focus();if(u.attr("IntervalTime",60),""==p)return changeRandomCode(),void $("#randomCode").focus();u.attr("IntervalTime",60);var m={70001105:rss_new.uc_error_10000001,70001401:rss_new.uc_error_10000001,70002001:rss_new.uc_error_10000001,70001201:rss_new.uc_error_10000001},T={userAccount:d,smsReqType:r,reqClientType:t,accountType:e,languageCode:localInfo.lang,mobilePhone:l,languageCode:localInfo.lang,operType:a};u.attr("disabled",!0),casAjaxObj.getSMSAuthCode(T,function C(){isMobile()?($("#errorTips").html(""),$("#errorTips").removeClass("addbtmpad-msg-top2p"),$("#codeInputDiv").removeClass("input-error-EMUI5"),wapToast(rss_new.uc_common_sms_has_sendto.format(getExpressPhone(T.mobilePhone)))):showMsgSuccess({obj:$("#msg_getAuthCode"),msg:rss_new.uc_common_sms_has_sendto.format(getExpressPhone(T.mobilePhone)),leftPix:"-239px",rightPix:"-239px",bottom:"39px"});u.attr("IntervalTime",60),u.addClass("auth_code_grey"),u.attr("disabled",!0),jsInnerTimeout()},function _(e){$("#errorTips").addClass("addbtmpad-msg-top2p"),$("#codeInputDiv").addClass("input-error-EMUI5"),u.removeAttr("disabled"),changeRandomCode(),$("#randomCode").val(""),$("#randomCode").focus(),showGetAuthCodeErrorForOld(e)},m)}function showGetAuthCodeErrorForOld(e){$("#errorTips").html(e)}function sendMobileCode(o){var e=o.userAccount,r=o.accountType,t=o.mobilephone,n=o.smsReqType,s=o.reqClientType,a=o.languageCode,i=o.operType,c=o.getCodeButton,l=$("#errorTips"),d={userAccount:e,smsReqType:n,reqClientType:s,accountType:r,languageCode:a,mobilePhone:t,operType:i};c.attr("disabled",!0);var u="getSMSAuthCode";function p(){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:u,actionIsSuccess:1}),o.successFunction&&o.successFunction(),c.attr("IntervalTime",60),c.addClass("auth_code_grey"),c.attr("disabled",!0),jsInnerTimeout()}function m(e,r){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:u,actionIsSuccess:0,actionErrorCode:r.errorCode}),c.removeAttr("disabled"),o.errorBorder&&o.errorBorder.addClass("input-error-EMUI5"),o.errorClass?l.addClass(o.errorClass).html(e):l.html(e)}2==localInfo.verifyAccountType||6==localInfo.verifyAccountType?(d.operType=25,d.loginChannel=localInfo.loginChannel,u="getSMSCodeV3",casAjaxObj.getSMSCodeV3(d,p,m)):casAjaxObj.getSMSAuthCode(d,p,m)}function sendEmailCode(o){var t=o.getCodeButton,n=o.errorTips,e={70001101:rss_new.uc_error_10000001,70001201:rss_new.uc_error_10000001,10000002:rss_new.uc_error_10000001,"default":rss_new.uc_error_10000001},r={email:o.email,userAccount:o.userAccount,accountType:o.accountType,emailReqType:o.emailReqType,languageCode:o.languageCode,reqClientType:o.reqClientType,operType:o.operType};t.attr("disabled",!0),casAjaxObj.getEMailAuthCode(r,function s(){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:"getEMailAuthCode",actionIsSuccess:1}),o.successFunction&&o.successFunction();t.attr("IntervalTime",60),t.attr("disabled",!0),t.addClass("auth_code_grey"),jsInnerTimeout()},function a(e,r){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:"getEMailAuthCode",actionIsSuccess:0,actionErrorCode:r.errorCode}),t.removeAttr("disabled"),o.errorBorder&&o.errorBorder.addClass("input-error-EMUI5");o.errorClass?n.addClass(o.errorClass).html(e):n.html(e)},e)}function chkAuthCode(o){var t=o.errorTips,e={accountType:o.accountType,userAccount:o.userAccount,authCode:o.authCode,authOprType:o.authOprType,reqClientType:o.reqClientType,operType:o.operType};casAjaxObj.chkAuthCode(e,function r(e){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkAuthCode",actionIsSuccess:1,message:e.analysisMessage,nextStepUrl:e.nextStepUrl}),o.successFunction&&o.successFunction(e)},function n(e,r){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkAuthCode",actionIsSuccess:0,actionErrorCode:r.errorCode,message:o.accountType}),o.errorBorder&&o.errorBorder.addClass("input-error-EMUI5");o.errorClass?t.addClass(o.errorClass).html(e):t.html(e)})}function pcToast(e,r){var o=countLength(r=xssFilter(r),"font-size:13px;padding:0 12px"),t="font-size:13px;text-align:center;background-color:rgba(209,209,209,0.9);border-radius: 16px;min-width: 76px;margin:0 auto;max-width: 236px;width:"+o+"px;";t+=260<o?"padding:6px 12px;":"padding:0 12px;height:32px;line-height:32px;";var n="toast"+(new Date).getTime(),s="<div  id='"+n+"'>"+r+"</div>";if(0<$("#toastContent").length)0<$("#toastContent div").length&&(s="<div  id='"+n+"'>"+r+"</div>"),$("#toastContent").append(s),$("#toastContent").find("#"+n).attr("style",t+"margin-top:10px");else{e.append("<div id='toastContent' style='position:absolute;top:64px;width:100%;z-index:100000'></div>"),$("#toastContent").append(s),$("#toastContent").find("#"+n).attr("style",t)}setTimeout(function(){$("#"+n).remove()},2e3)}function countLength(e,r){e=xssFilter(e.trim());var o="count"+(new Date).getTime();r+=";visibility:hidden;word-wrap:break-word;word-break:break-all;";var t="<span id='"+o+"'>"+e+"</span>";$("body").append(t),$("body").find("#"+o).attr("style",r);var n=$("#"+o)[0].offsetWidth;return $("#"+o).remove(),n}function jsInnerTimeout(){var e=$("#getValiCode"),r=parseInt(e.attr("IntervalTime"));if(r--,e.attr("disabled",!0),r<=-1)return e.removeAttr("disabled"),e.removeClass("auth_code_grey"),isMobile()&&(e.attr("type")&&"button"==e.attr("type").toLowerCase()?e.val(rss_new.common_Resend):e.find("span,a").text(rss_new.common_Resend)),e.val(rss_new.common_Resend),e.find("span:first,a:first").text(rss_new.common_Resend),e.attr("IntervalTime",60),!0;isMobile()?e.attr("type")&&"button"==e.attr("type").toLowerCase()?e.val(rss_new.common_Resend_time.format(r)):e.find("span,a").text(rss_new.common_Resend_time.format(r)):(e.val(rss_new.common_Resend_time.format(r)),e.find("span:first,a:first").text(rss_new.common_Resend_time.format(r))),e.attr("IntervalTime",r),setTimeout("jsInnerTimeout()",1e3)}function isMobile(){for(var e=navigator.userAgent,r=["Android","iPhone","SymbianOS","Mobile","Windows Phone","iPad","iPod"],o=!1,t=0;t<r.length;t++)if(0<e.indexOf(r[t])){o=!0;break}return o}function getTwoFacRecovery(e,r){ajaxHandler("getTwoFacRecovery",{},function(e){e.accountRecoverState;var r=e.errorCode;return"1"==e.isSuccess?(localInfo.clientNonce?gotoUrl(e.nextStepUrl+localInfo.urlQurey+"&sceneID=1&clientNonce="+localInfo.clientNonce+"&extInfo="+e.extInfo):gotoUrl(e.nextStepUrl+localInfo.urlQurey+"&sceneID=1&extInfo="+e.extInfo),!0):("10000001"==r?$("#error-tips").html(rss_new.uc_error_10000001):"10000004"==r?$("#error-tips").html(rss_new.uc_error_10000004):"10000002"==r?$("#error-tips").html(rss_new.uc_error_10000002):"10000003"==r?$("#error-tips").html(rss_new.uc_error_10000003):"10001003"==r?showUsernameError(rss_new.uc_error_10001003):"10001004"==r?showUsernameError(rss_new.uc_error_10000004):"70001401"==e.errorCode?$("#error-tips").html(rss_new.uc_error_70001401):$("#error-tips").html(rss_new.resetpwd_accountinfo_not_exist),!1)})}function showErrorNew(e,r,o){e?(e.addClass("input-error-EMUI5"),r.html(o).addClass("error-tips-EMUI5")):r.html(o).addClass("errorColor")}function hideErrorNew(e,r){e.removeClass("input-error-EMUI5"),r.html("").removeClass("error-tips-EMUI5")}function hideErrorBox(e){e.removeClass("input-error-EMUI5")}function showPopError(e){showSystemError(e,rss_new.box_js_confirm)}function chkReRegister(t){var n=t.errorTips,e={accountType:t.accountType,userAccount:t.userAccount,authCode:t.authCode,authOprType:t.authOprType,reqClientType:t.reqClientType,lang:localInfo.lang,operType:t.operType};casAjaxObj.chkReRegister(e,function r(e){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkReRegister",actionIsSuccess:1,message:e.analysisMessage,nextStepUrl:e.nextStepUrl}),"762"!=localInfo.reqClientType&&"true"==localInfo.isSameAsInput&&e&&1==e.reRegisterFlag&&e.siteInfoList&&0<e.siteInfoList.length?popIsNewFromOld(e.siteInfoList[0],e.regExtInfo,t.successFunction,e):t.successFunction&&t.successFunction(e)},function s(e,r){var o='{"verifyAccountType":'+t.accountType+"}";analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkReRegister",actionIsSuccess:0,actionErrorCode:r.errorCode,message:o}),t.errorBorder&&t.errorBorder.addClass("input-error-EMUI5");t.errorClass?n.addClass(t.errorClass).html(e):n.html(e)})}function popIsNewFromOld(e,r,o,t){e=e||{};var n=localInfo.verifyUserAccount,s={userAccount:n,userAvatar:e.avatar,userNickName:e.nickName||"",userPhoneNum:n};$("<div/>").Dialog({title:rss_new.reg_again_title,titleUnderline:!1,btnRight:{text:rss_new.login_bind_pwd_contine,fn:function(){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_TWICE_CONTINUE"}),o(t)}},cancelFn:function(){this.hide()},btnLeft:{text:rss_new.login_bind_pwd_cancel,fn:function(){window.webLoader?(analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_TWICE_REG",message:"1"}),window.webLoader.intoApp("ok")):(analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_TWICE_REG",message:"2",nextStepUrl:localInfo.registerLink+"&fregExtInfo="+r}),gotoUrl(localInfo.registerLink+"&fregExtInfo="+r))}},html:'<div class="normal-color reg-user-desc">'+rss_new.reg_again_content.format(s.userAccount)+'</div><div class="marginTop8 center reg-user-info"><div class="reg-avatar '+(s.userAvatar?"avatarCircle":"")+'"><img src="'+(s.userAvatar||localInfo.defaultAvatar)+'" alt="" onerror="this.src = localInfo.defaultAvatar;this.onerror = null;"/></div><div class="marginTop8 normal-color medium">'+s.userNickName+'</div><p class="marginTop8 font-desc" style="margin-bottom: 36px;"><span class="nophonewrap userAccount">'+s.userPhoneNum+"</span></p></div>"}).Dialog("show")}$(function(){2==localInfo.verifyAccountType||6==localInfo.verifyAccountType?$.label($("#authcode"),rss_new.registerbyphone_js_codelength):$.label($("#authcode"),rss_new.registerbyphone_js_emailcodelength);var n=$("#authcode");n.validator("bind",{type:["require","length"],validOnChange:!1,trim:!0,max:8,min:4,errorFunction:function(e,r){switch(r.type){case"require":showAuthCodeError(rss_new.common_js_inputcode);break;case"length":showAuthCodeError(rss_new.common_js_wrongcode)}},successFunction:function(e,r){},reInputFunction:function(){hideAuthCodeError()}}),n.on("keyup change paste",function(){setTimeout(function(){notifyEnableNextBtn(n.val().trim())},0)}),$("#next").on("click",function(){if(!$("#next").hasClass("disabled")){var e=$(".form-edit-area")[0];if(!validator(e,!0))return!1;var r=$("#errorTips"),o=$("#pc-toast"),t={accountType:localInfo.verifyAccountType,userAccount:localInfo.verifyUserAccount,authCode:n.val().trim(),authOprType:"1",reqClientType:localInfo.reqClientType,operType:"12",errorTips:r,errorBorder:o,errorClass:"authCode-errorTips",successFunction:function(e){0<=e.nextStepUrl.indexOf("?")&&0<=localInfo.resetPwdUrlQuery.indexOf("?")?gotoUrl(e.nextStepUrl+"&"+localInfo.resetPwdUrlQuery.substring(1)):gotoUrl(e.nextStepUrl+localInfo.resetPwdUrlQuery)}};2==localInfo.verifyAccountType||6==localInfo.verifyAccountType?(t.operType=16,t.lang=localInfo.lang,chkReRegister(t)):chkAuthCode(t)}})});