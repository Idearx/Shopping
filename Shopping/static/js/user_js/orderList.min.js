ec.pkg("ec.member.orderList");
ec.load("ajax");
ec.load("ec.box", {"loadType": "lazy"});
ec.load("jquery.movebar");
var msgStartTag = '\x3cspan class\x3d"label-error red"\x3e';
var msgEndTag = "\x3c/span\x3e";
var sbomCouponList = {};
ec.member.orderList.openAddRemarkView = function (orderInfo) {
    $.ajax({
        url: "/member/addUserRemarkView",
        dataType: "json",
        data: {"orderCode": orderInfo, "t": (new Date).getTime()},
        type: "post",
        success: function (result) {
            var $result = $(result);
            if ($result.length == 1 && $result.hasClass("errorMsg")) {
                var txt = encodeURIComponent($result.text());
                (new ec.box($("#box_no_remark_orderlist_error").val(), {
                    boxid: "box_no_remark_orderlist_error",
                    boxclass: "ol_box_4",
                    showTitle: true,
                    showCancel: false,
                    showOk: false,
                    width: 600,
                    timeout: 2E5,
                    onclose: function (dom) {
                        ec.redirectTo("/member/order?t\x3d" + (new Date).getTime())
                    },
                    onok: function (dom) {
                        ec.redirectTo("/member/order?t\x3d" + (new Date).getTime())
                    }
                })).open();
                $("#errorMsg_orderlist").textS(txt)
            } else {
                $("div.u-4-5").html(result);
                ec.member.add.showView()
            }
        }
    })
};
ec.member.orderList.getUserOrderRemarkStatus = function (isHisData) {
    if ($("#colid").val() == "0" || isHisData == "0") return;
    var orderlist = "";
    var firstOrder = true;
    $(".button-operate-revie").each(function () {
        if (firstOrder) {
            orderlist = $(this).attr("orderInfo");
            firstOrder = false
        } else orderlist += "," + $(this).attr("orderInfo")
    });
    if (orderlist != "") $.ajax({
        url: openApiDomain + "/rms/comment/getOrderCommentStatus.json",
        type: "POST",
        dataType: "json",
        data: JSON.stringify({"orderCode": orderlist, "t": (new Date).getTime()}),
        timeout: 1E4,
        beforeSend: function (xhr) {
            xhr.withCredentials = true
        },
        success: function (json) {
            $(".button-operate-revie").each(function () {
                var p;
                var orderInfo = $(this).attr("orderInfo");
                if (json.data && json.data != undefined) for (var i = 0; i < json.data.length; i++) {
                    p = json.data[i];
                    if (orderInfo == p.orderCode && p.status == 1) {
                        $(this).attr("href", "javascript:ec.member.orderList.commentsRealName(" + p.orderCode + ")");
                        $(this).attr("title", "\u6211\u8981\u8bc4\u8bba");
                        $(this).attr("innerHTML", "\x3cspan\x3e\u6211\u8981\u8bc4\u8bba\x3c/span\x3e");
                        $(this).parent(".p-button").removeClass("hide")
                    }
                }
            })
        }
    })
};
ec.member.orderList.commentsRealName = function (orderCode) {
    $.ajax({
        url: domainMain + "/member/addUserRemarkView.json",
        dataType: "json",
        type: "post",
        data: {"orderCode": orderCode, "t": (new Date).getTime()},
        timeout: 1E4,
        success: function (json) {
            if (json.success) ec.postTo("/member/addUserRemarkView", {orderCode: orderCode}); else ec.account.syncCustomSession(function (callJson) {
                if (callJson == null || callJson.customerInfo.userState == null) {
                    ec.postTo("/member/addUserRemarkView", {orderCode: orderCode});
                    return
                } else ec.member.orderList.vildateComments(orderCode)
            })
        }
    })
};
ec.member.orderList.vildateComments = function (orderCode) {
    $.ajax({
        url: domainMain + "/member/addUserRemarkView.json",
        dataType: "json",
        type: "post",
        data: {"orderCode": orderCode, "t": (new Date).getTime()},
        timeout: 1E4,
        error: function () {
            // alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")
        },
        success: function (json) {
            if (json.success) ec.postTo("/member/addUserRemarkView", {orderCode: orderCode}); else ec.member.orderList.commentsTip()
        }
    })
};
ec.member.orderList.remindBox = function (msg, orderCode) {
    (new ec.box(msg, {
        boxclass: "ol_box_4 small",
        title: "",
        width: "",
        showButton: false,
        autoHeight: false,
        onok: function (box) {
            $.ajax({
                type: "POST",
                url: "/member/order/remind.json",
                data: {"orderCode": orderCode},
                dataType: "json",
                timeout: 2E3,
                success: function (json) {
                }
            });
            box.close()
        }
    })).open()
};
ec.member.orderList.commentsTip = function () {
    (new ec.box($("#realNameComment").val(), {
        boxclass: "ol_box_4",
        title: "",
        width: 540,
        showButton: false,
        autoHeight: false,
        onok: function () {
        }
    })).open()
};
ec.member.orderList.unpayTip = function () {
    (new ec.box($("#unPay-inOnce").val(), {
        boxclass: "ol_box_4 small",
        title: "",
        showButton: false,
        autoHeight: false,
        onok: function () {
        }
    })).open()
};
ec.ready(function () {
    $("#ec_ui_confirm").click(function (event) {
        event = event || window.event;
        event.stopPropagation()
    });
    $(document).bind("click", function (e) {
        var e = e || window.event;
        var elem = e.target || e.srcElement;
        if (elem.innerHTML != "\u53d6\u6d88\u8ba2\u5355" && elem.innerHTML != "\u5220\u9664\u8ba2\u5355") $("#ec_ui_confirm").hide()
    });
    $("#li-order").addClass("current");
    $("#pathTitle").html("\u6211\u7684\u8ba2\u5355");
    ec.member.orderList.interfaceTpl = new ec.template($("#interface-tpl").val());
    window.onhashchange = function () {
        var hash = window.location.hash;
        if (hash && hash.length > 0) {
            hash = hash.substring(1, hash.length);
            if (hash.length > 0) ec.member.orderList.openAddRemarkView(hash); else window.location.reload()
        } else window.location.reload()
    };
    var hash = window.location.hash;
    if (hash && hash.length > 0) {
        hash = hash.substring(1, hash.length);
        if (hash.length > 0) {
            ec.member.orderList.openAddRemarkView(hash);
            return
        }
    }
    ec.member.orderList.getUserOrderRemarkStatus();
    if ($(".list-group-item").length < 1) $("#order-merge-pay").hide()
});
ec.member.orderList.load = function (page) {
    var _url, _dataType, symbol, params, _method;
    _method = "post";
    if ($("#checkid").val() == "nocomment") {
        _url = openApiDomain + "/rms/comment/getNoCommentOrders.json?t\x3d" + (new Date).getTime();
        _dataType = "json";
        symbol = 0;
        params = JSON.stringify({"pageNum": page.pageNumber, "pageSize": 5})
    } else {
        _url = domainMain + "/member/order.json?t\x3d" + (new Date).getTime();
        _dataType = "json";
        _method = "get";
        symbol = 1;
        params = {
            "dateType": $("#colid").val(),
            "tab": $("#checkid").val(),
            "pageNumber": page.pageNumber,
            "pageSize": 5
        }
    }
    var sbomCouponListInfo = sbomCouponList[page.pageNumber];
    if ($("#checkid").val() == "nocomment" && sbomCouponListInfo && sbomCouponListInfo.resultCode == 0) {
        var json = sbomCouponListInfo;
        ec.member.orderList.push(json, symbol);
        if (json.orderList && json.orderList.length > 0) if ($("input[name\x3d'payCheck']").length == 0 || $("input[name\x3d'payCheck']").length == 1) {
            if (!$("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").addClass("hide");
            if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
        } else {
            $("#checkAllBox").prop("checked", false);
            $("#bottomCheckAllBox").prop("checked", false);
            if ($("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").removeClass("hide");
            if ($("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").removeClass("hide")
        } else {
            if (!$("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").addClass("hide");
            if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
        }
    } else $.ajax({
        url: _url, dataType: _dataType, data: params, type: _method, timeout: 1E4, error: function () {
            // alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")
        }, beforeSend: function (xhr) {
            ec.ui.loading.show({modal: false});
            xhr.withCredentials = true
        }, success: function (json) {
            ec.ui.loading.hide();
            if (0 == symbol) {
                if (json.resultCode != 0) {
                    if (json.resultCode == "42003") {
                        ec.account.loginName = "";
                        ec.account.afterLogin(function () {
                            ec.member.orderList.load(page)
                        })
                    } else alert("\u5f88\u62b1\u6b49\uff01\u8ba2\u5355\u5217\u8868\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c");
                    return
                }
            } else if (!json.success) {
                if (json.code == "login") {
                    ec.account.loginName = "";
                    ec.account.afterLogin(function () {
                        ec.member.orderList.load(page)
                    })
                } else alert("\u5f88\u62b1\u6b49\uff01\u8ba2\u5355\u5217\u8868\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c");
                return
            }
            ec.member.orderList.push(json, symbol);
            if ($("#checkid").val() == "nocomment") sbomCouponList[page.pageNumber] = json;
            if (json.orderList && json.orderList.length > 0) if ($("input[name\x3d'payCheck']").length == 0 || $("input[name\x3d'payCheck']").length == 1) {
                if (!$("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").addClass("hide");
                if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
            } else {
                $("#checkAllBox").prop("checked", false);
                $("#bottomCheckAllBox").prop("checked", false);
                if ($("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").removeClass("hide");
                if ($("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").removeClass("hide")
            } else {
                if (!$("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").addClass("hide");
                if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
            }
        }
    })
};
ec.member.orderList.push = function (json, symbol) {
    var html = [], p, isHisData, orderList, jsonPage, dataType = $("#colid").val(), dateStr = "";
    if (0 == symbol) {
        orderList = json.data.orderList;
        jsonPage = json.data.page
    } else {
        orderList = json.orderList;
        jsonPage = json.page
    }
    if (orderList && orderList.length > 0) {
        for (var i = 0; i < orderList.length; i++) {
            var tempClearingTips;
            p = orderList[i];
            isHisData = dataType == 0 && p.isHisData == 0 ? "0" : "1", paymentText = p.paymentStatus == 1 ? "\u5df2\u4ed8\u6b3e" : "\u5f85\u652f\u4ed8";
            if (p.orderClearing != null) tempClearingTips = "true"; else tempClearingTips = "false";
            if (p.orderStatus == "4" || p.orderStatus == "8") dateStr = ec.util.parseDate(p.orderDate).format("yyyy-MM-dd") + "\x26nbsp;\x26nbsp;" + ec.util.parseDate(p.orderDate).format("HH:mm"); else if (p.orderStatus == "7") dateStr = ec.util.parseDate(p.orderDate).format("yyyy-MM-dd") + "\x26nbsp;\x26nbsp;" + ec.util.parseDate(p.orderDate).format("HH:mm"); else dateStr = ec.util.parseDate(p.orderDate).format("yyyy-MM-dd") + "\x26nbsp;\x26nbsp;" + ec.util.parseDate(p.orderDate).format("HH:mm");
            html.push('\x3cdiv class\x3d"list-group-item"\x3e\x3cdiv class\x3d"o-info"\x3e');
            if (p.orderStatus == 8) {
                html.push('\x3cdiv class\x3d"col-info"\x3e');
                var isPass = p.type != 10 && p.type != 18 && (p.paymentStatus == 2 || p.paymentStatus == 3) && (p.orderStatus == 3 || p.orderStatus < 3 && p.orderSource != 2);
                if (isPass) html.push('\x3cinput type\x3d"checkbox" class\x3d"checkbox" name\x3d"payCheck" paymentStatus\x3d"' + p.paymentStatus + '"' + 'clearOrder\x3d"' + tempClearingTips + '" value\x3d"' + p.orderCode + '"/\x3e');
                if (p.type == 22) html.push('\x3cspan class\x3d"o-icon"\x3e\u5956\u54c1\x3c/span\x3e');
                html.push('\x3cspan class\x3d"o-date"\x3e' + dateStr + '\x3c/span\x3e\x3cspan class\x3d"o-no"\x3e\u8ba2\u5355\u53f7\uff1a');
                html.push("\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + p.orderCode + "', isHisData: '" + isHisData + '\'});" href\x3d"javascript:;" title\x3d"' + p.orderCode + '"\x3e' + p.orderCode + "\x3c/a\x3e\x3c/span\x3e");
                if (p.type == 33 || p.type == 39) html.push('\x3cspan class\x3d"o-icon-1"\x3e\u62fc\u8d2d\x3c/span\x3e');
                if (p.type == 26) html.push('\x3cspan class\x3d"icon-priority"\x3e\x3c/span\x3e');
                html.push('\x3c/div\x3e\x3cdiv class\x3d"col-state"\x3e');
                if (p.paymentStatus == 1) html.push("\u5df2\u53d6\u6d88\x26nbsp;|\x26nbsp;\u5df2\u4ed8\u6b3e"); else if (p.paymentStatus == 2) html.push("\u5df2\u53d6\u6d88"); else if (p.paymentStatus == 3) if (p.type == 10 || p.type == 18) html.push("\u5df2\u652f\u4ed8\u8ba2\u91d1"); else html.push("\u5df2\u90e8\u5206\u4ed8\u6b3e"); else html.push("\u5f85\u652f\u4ed8");
                html.push("\x3c/div\x3e")
            } else if (p.orderStatus == 12) {
                html.push('\x3cdiv class\x3d"col-info"\x3e');
                var isPass = p.type != 10 && p.type != 18 && (p.paymentStatus == 2 || p.paymentStatus == 3) && (p.orderStatus == 3 || p.orderStatus < 3 && p.orderSource != 2);
                if (isPass) html.push('\x3cinput type\x3d"checkbox" class\x3d"checkbox" name\x3d"payCheck" paymentStatus\x3d"' + p.paymentStatus + '"' + 'clearOrder\x3d"' + tempClearingTips + '" value\x3d"' + p.orderCode + '"/\x3e');
                if (p.type == 22) html.push('\x3cspan class\x3d"o-icon"\x3e\u5956\u54c1\x3c/span\x3e');
                html.push('\x3cspan class\x3d"o-date"\x3e' + dateStr + '\x3c/span\x3e\x3cspan class\x3d"o-no"\x3e\u8ba2\u5355\u53f7\uff1a');
                html.push("\x3ca onclick\x3d\"ec.postTo('/member/order/detail?isHisData\x3d" + isHisData + "', {orderCode:'" + p.orderCode + '\'});" href\x3d"javascript:;" title\x3d"' + p.orderCode + '"\x3e' + p.orderCode + "\x3c/a\x3e\x3c/span\x3e");
                if (p.type == 33 || p.type == 39) html.push('\x3cspan class\x3d"o-icon-1"\x3e\u62fc\u8d2d\x3c/span\x3e');
                if (p.type == 26) html.push('\x3cspan class\x3d"icon-priority"\x3e\x3c/span\x3e');
                html.push('\x3c/div\x3e\x3cdiv class\x3d"col-state"\x3e');
                if (p.paymentStatus == 2) html.push("\u5173\u95ed\u652f\u4ed8\x26nbsp;|\x26nbsp;\u672a\u652f\u4ed8"); else if (p.paymentStatus == 1) html.push("\u5173\u95ed\u652f\u4ed8\x26nbsp;|\x26nbsp;\u5df2\u652f\u4ed8"); else html.push("\u5173\u95ed\u652f\u4ed8\x26nbsp;|\x26nbsp;\u5f85\u652f\u4ed8");
                html.push("\x3c/div\x3e")
            } else if (p.orderStatus == 7) {
                html.push('\x3cdiv class\x3d"col-info"\x3e');
                var isPass = p.type != 10 && p.type != 18 && (p.paymentStatus == 2 || p.paymentStatus == 3) && (p.orderStatus == 3 || p.orderStatus < 3 && p.orderSource != 2);
                if (isPass) html.push('\x3cinput type\x3d"checkbox" class\x3d"checkbox" name\x3d"payCheck" paymentStatus\x3d"' + p.paymentStatus + '"' + 'clearOrder\x3d"' + tempClearingTips + '" value\x3d"' + p.orderCode + '"/\x3e');
                if (p.type == 22) html.push('\x3cspan class\x3d"o-icon"\x3e\u5956\u54c1\x3c/span\x3e');
                html.push('\x3cspan class\x3d"o-date"\x3e' + dateStr + '\x3c/span\x3e\x3cspan class\x3d"o-no"\x3e\u8ba2\u5355\u53f7\uff1a');
                html.push("\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + p.orderCode + "', isHisData: '" + isHisData + '\'});" href\x3d"javascript:;" title\x3d"' + p.orderCode + '"\x3e' + p.orderCode + "\x3c/a\x3e\x3c/span\x3e");
                if (p.type == 33 || p.type == 39) html.push('\x3cspan class\x3d"o-icon-1"\x3e\u62fc\u8d2d\x3c/span\x3e');
                if (p.type == 26) html.push('\x3cspan class\x3d"icon-priority"\x3e\x3c/span\x3e');
                if (p.type == 28 || p.type == 36 || p.type == 35) ; else {
                    html.push('\x3cspan class\x3d"o-logistics"\x3e');
                    html.push('\x3ca href\x3d"javascript:;" onmouseover\x3d"ec.member.orderList.openLog(this, ' + ec.encodeForJS(p.orderCode) + ')"\x3e\u7269\u6d41\u4fe1\u606f\x3c/a\x3e');
                    html.push('\x3cdiv class\x3d"o-logistics-record" id\x3d"interface-dialog-' + p.orderCode + '"\x3e');
                    html.push('\x3cdiv class\x3d"o-logistics-list" id\x3d"interface-msg-' + p.orderCode + '"\x3e');
                    html.push('\x3cdiv class\x3d"o-logistics-list-loading"\x3e\u52a0\u8f7d\u4e2d\x3c/div\x3e\x3c/div\x3e\x3cs\x3e\x3c/s\x3e\x3c/div\x3e\x3c/span\x3e')
                }
                html.push('\x3c/div\x3e\x3cdiv class\x3d"col-state"\x3e' + p.orderStatusText + "\x26nbsp;|\x26nbsp;");
                if (p.paymentStatus == 1) html.push("\u5df2\u4ed8\u6b3e"); else if (p.paymentStatus == 2) html.push("\u5df2\u53d6\u6d88"); else html.push("\u5f85\u652f\u4ed8");
                html.push("\x3c/div\x3e")
            } else {
                html.push('\x3cdiv class\x3d"col-info"\x3e');
                var isPass = p.type != 10 && p.type != 18 && (p.paymentStatus == 2 || p.paymentStatus == 3) && (p.orderStatus == 3 || p.orderStatus < 3 && p.orderSource != 2);
                if (isPass) html.push('\x3cinput type\x3d"checkbox" class\x3d"checkbox" name\x3d"payCheck" paymentStatus\x3d"' + p.paymentStatus + '"' + 'clearOrder\x3d"' + tempClearingTips + '" value\x3d"' + p.orderCode + '"/\x3e');
                if (p.type == 22) html.push('\x3cspan class\x3d"o-icon"\x3e\u5956\u54c1\x3c/span\x3e');
                html.push('\x3cspan class\x3d"o-date"\x3e' + dateStr + '\x3c/span\x3e\x3cspan class\x3d"o-no"\x3e\u8ba2\u5355\u53f7\uff1a');
                html.push("\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + p.orderCode + "', isHisData: '" + isHisData + '\'});" href\x3d"javascript:;" title\x3d"' + p.orderCode + '"\x3e' + p.orderCode + "\x3c/a\x3e\x3c/span\x3e");
                if (p.type == 33 || p.type == 39) html.push('\x3cspan class\x3d"o-icon-1"\x3e\u62fc\u8d2d\x3c/span\x3e');
                if (p.type == 26) html.push('\x3cspan class\x3d"icon-priority"\x3e\x3c/span\x3e');
                if (p.orderStatus == 6) if (p.type == 28 || p.type == 36 || p.type == 35) ; else {
                    html.push('\x3cspan class\x3d"o-logistics"\x3e');
                    html.push('\x3ca href\x3d"javascript:;" onmouseover\x3d"ec.member.orderList.openLog(this, ' + ec.encodeForJS(p.orderCode) + ')"\x3e\u7269\u6d41\u4fe1\u606f\x3c/a\x3e');
                    html.push('\x3cdiv class\x3d"o-logistics-record" id\x3d"interface-dialog-' + p.orderCode + '"\x3e');
                    html.push('\x3cdiv class\x3d"o-logistics-list" id\x3d"interface-msg-' + p.orderCode + '"\x3e');
                    html.push('\x3cdiv class\x3d"o-logistics-list-loading"\x3e\u52a0\u8f7d\u4e2d\x3c/div\x3e\x3c/div\x3e\x3cs\x3e\x3c/s\x3e\x3c/div\x3e\x3c/span\x3e')
                }
                html.push('\x3c/div\x3e\x3cdiv class\x3d"col-state"\x3e');
                if ((p.type == 33 || p.type == 39) && p.orderStatus == 1 && p.paymentStatus == 1) html.push("\u62fc\u56e2\u4e2d\x26nbsp;|\x26nbsp;"); else if (p.type == 33 && p.orderStatus == 3 && p.paymentStatus == 1) html.push("\u7b49\u5f85\u51fa\u5e93\x26nbsp;|\x26nbsp;"); else if (p.type == 39 && p.orderStatus == 3 && p.paymentStatus == 1) html.push("\u7b49\u5f85\u5f00\u5956\x26nbsp;|\x26nbsp;"); else if (p.type == 39 && p.orderStatus == 21 && p.paymentStatus == 1) html.push("\u5df2\u5f00\u5956\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 4) html.push("\u5ba1\u6838\u672a\u901a\u8fc7\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 12) html.push("\u5173\u95ed\u652f\u4ed8\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 3) html.push("\u8ba2\u5355\u5df2\u786e\u8ba4\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 9) if (p.isSelfPickup == 1) html.push("\u5f85\u95e8\u5e97\u786e\u8ba4\x26nbsp;|\x26nbsp;"); else html.push("\u6b63\u5728\u51fa\u5e93\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 5) if (p.isSelfPickup == 1) html.push("\u5f85\u81ea\u63d0\x26nbsp;|\x26nbsp;"); else html.push("\u5df2\u51fa\u5e93\x26nbsp;|\x26nbsp;"); else if ((p.orderStatus == 6 || p.orderStatus == 15) && p.type == 35) html.push("\u5f85\u4f7f\u7528\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 6 || p.orderStatus == 15) if (p.isSelfPickup == 1) html.push("\u5df2\u81ea\u63d0\x26nbsp;|\x26nbsp;"); else html.push("\u5df2\u53d1\u8d27\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 7) if (p.isSelfPickup == 1) html.push("\u5df2\u81ea\u63d0\x26nbsp;|\x26nbsp;"); else html.push("\u5df2\u5b8c\u6210\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 14 && p.type == 35) html.push("\u670d\u52a1\u6743\u76ca\u5931\u6548\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 14) html.push("\u5df2\u62d2\u6536\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 16) html.push("\u53d6\u6d88\u5904\u7406\u4e2d\x26nbsp;|\x26nbsp;"); else if (p.orderStatus == 17) html.push("\u4fee\u6539\u5904\u7406\u4e2d\x26nbsp;|\x26nbsp;"); else html.push(p.orderStatusText + "\x26nbsp;|\x26nbsp;");
                if (p.paymentStatus == 1) html.push("\u5df2\u4ed8\u6b3e"); else if (p.paymentStatus == 3) html.push("\u5df2\u90e8\u5206\u4ed8\u6b3e"); else html.push("\u5f85\u652f\u4ed8");
                html.push("\x3c/div\x3e")
            }
            html.push("\x3c/div\x3e");
            if (p.type == 10 && p.subStatus == 0 && p.orderDetailDesc && "" != p.orderDetailDesc && p.paymentStatus != 1 && p.orderStatus != 8) html.push('\x3cdiv class\x3d"myOrder-record-tips"\x3e' + p.orderDetailDesc + "\x3c/div\x3e");
            html.push('\x3cdiv class\x3d"o-pro"\x3e\x3ctable border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctbody\x3e');
            html.push(ec.member.orderList.productList(p));
            html.push("\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e");
            if (p.type == 10 || p.type == 18) html.push(ec.member.orderList.depositList(p));
            html.push("\x3c/div\x3e")
        }
        $("#list-group").html(html.join(""));
        if ($("#checkid").val() == "nocomment") {
            var skuCode = [];
            for (var i = 0; i < orderList.length; i++) for (var j = 0; j < orderList[i].productList.length; j++) {
                skuCode.push(orderList[i].productList[j].skuCode);
                for (var k = 0; k < orderList[i].productList[j].giftList.length; k++) skuCode.push(orderList[i].productList[j].giftList[k].giftSkuCode)
            }
            var skuLen = skuCode.length;
            if (skuLen <= 50) ec.member.orderList.loadImg(skuCode); else {
                var times = Math.ceil(skuLen / 50);
                for (var i = 0; i < times; i++) {
                    var j = i * 50;
                    if (i + 1 == times) ec.member.orderList.loadImg(skuCode.slice(j, skuLen)); else ec.member.orderList.loadImg(skuCode.slice(j, j + 50))
                }
            }
            $(".button-operate-revie").each(function () {
                var p;
                var orderInfo = $(this).attr("orderInfo");
                if (orderList && orderList.length > 0) for (var i = 0; i < orderList.length; i++) {
                    p = orderList[i];
                    if (orderInfo == p.orderCode) {
                        $(this).attr("href", "javascript:ec.member.orderList.commentsRealName(" + p.orderCode + ")");
                        $(this).attr("title", "\u6211\u8981\u8bc4\u8bba");
                        $(this).attr("innerHTML", "\x3cspan\x3e\u6211\u8981\u8bc4\u8bba\x3c/span\x3e");
                        $(this).parent(".p-button").removeClass("hide")
                    }
                }
            });
            ec.member.orderList.renderPage(jsonPage)
        } else {
            ec.member.orderList.renderPage(jsonPage);
            ec.ui.scrollTo("#myOrder-cate");
            ec.member.orderList.getUserOrderRemarkStatus(isHisData);
            ec.member.orderList.payClick()
        }
    } else {
        ec.member.orderList.bottomCheckBoxDisplay(false);
        $("#list-group").html('\x3cdiv class\x3d"list-group-empty"\x3e\u60a8\u6682\u65f6\u6ca1\u6709\u76f8\u5173\u8bb0\u5f55\u3002\x3c/div\x3e');
        $("#list-pager").html("");
        ec.member.orderList.getUserOrderRemarkStatus(isHisData);
        ec.member.orderList.payClick()
    }
};
ec.member.orderList.loadImg = function (skuCode) {
    (new ec.ajax).get({
        url: domainMain + "/product/querySbomCodesInfo.json",
        data: {"skuCodes": skuCode.join(",")},
        dataType: "json",
        async: false,
        timeout: 1E4,
        timeoutFunction: function () {
            // alert(timeOutInfo)
        },
        successFunction: function (json) {
            if (!json || !json.sbomBaseInfoList) {
                alert("\u5f88\u62b1\u6b49\uff01\u5546\u54c1\u56fe\u7247\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c");
                return
            }
            for (var i = 0; i < json.sbomBaseInfoList.length; i++) {
                var p = json.sbomBaseInfoList[i];
                $(".nocomment-" + p.sbomCode).attrS("src", ec.mediaPath + "/" + p.photoPath + "100_100_" + p.photoName).attrS("alt", p.sbomName);
                $(".nocomment-" + p.sbomCode).parent("a").attrS("href", "/product/" + p.disPrdId + ".html#" + p.sbomId);
                $(".nocomment-" + p.sbomCode).attrS("href", "/product/" + p.disPrdId + ".html#" + p.sbomId);
                if ($(".pl-" + p.sbomCode).html()) $(".pl-" + p.sbomCode).attrS("orderinfo", $(".pl-" + p.sbomCode).attr("orderinfo").replace("${proId}", p.disPrdId))
            }
            ec.member.orderList.bottomCheckBoxDisplay(true);
            ec.ui.scrollTo("#myOrder-cate");
            ec.member.orderList.payClick()
        }
    })
};
ec.member.orderList.bottomCheckBoxDisplay = function (isShow) {
    if (isShow && $("#checkid").val() != "nocomment") {
        if ($("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").removeClass("hide");
        $("#bottomCheckAllBox").prop("checked", false)
    } else if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
};
ec.member.orderList.productList = function (lst) {
    var html = [], p, b, bundlerSize = 0, prdSize = 0, giftSize = 0, paymentList, productList, paymentType_,
        paymentMethod_, code = "\u7acb\u5373\u652f\u4ed8",
        paymentType = ["\u652f\u4ed8\u5b9d", "\u7f51\u94f6\u652f\u4ed8", "\u8d27\u5230\u4ed8\u6b3e", "\u9000\u6362\u8d27", "\u5feb\u6377\u652f\u4ed8", "\u7ebf\u4e0b\u652f\u4ed8", "\u8d22\u4ed8\u901a", "\u534e\u4e3a\u652f\u4ed8", "\u7ebf\u4e0b\u652f\u4ed8", "\u94f6\u8054\u5728\u7ebf\u652f\u4ed8"],
        dataType = $("#colid").val(), isHisData = dataType == 0 && lst.isHisData == 0 ? "0" : "1",
        paymentList = lst.paymentList || [];
    if (paymentList.length > 0) {
        paymentType_ = "66";
        paymentMethod_ = "BALANCE";
        for (var i = 0; i < paymentList.length; i++) if (paymentList[i].paymentMethod != "BALANCE" && paymentList[i].paymentType != "66") {
            paymentType_ = paymentList[i].paymentType;
            paymentMethod_ = paymentList[i].paymentMethod
        }
    }
    _showPaymentText = function (t, m) {
        t = parseInt(t, 10);
        if (!t || t < 1 || !m) return "";
        if (m == "BALANCE" && t == "66") return "\u4ee3\u91d1\u5238\u652f\u4ed8";
        if (t == 17) return "\u5fae\u4fe1\u652f\u4ed8";
        if (t == 1 && m == "HB") return "\u82b1\u5457\u652f\u4ed8";
        if (t == 17 || t == 67) return "\u5fae\u4fe1\u652f\u4ed8";
        if (t == 82 && m == "CMBLIFE_CMBLIFE") return "\u638c\u4e0a\u751f\u6d3b";
        if (t == 82 && m == "ICBC_ICBC") return "\u5de5\u884c\u4fe1\u7528\u5361\u652f\u4ed8";
        if (t == 82 && m == "ABC_ABC") return "\u519c\u884c\u4fe1\u7528\u5361\u652f\u4ed8";
        if (t == 82 && m == "BOC_BOC") return "\u4e2d\u884c\u4fe1\u7528\u5361\u652f\u4ed8";
        if (t == 84) return "\u7f51\u94f6\u652f\u4ed8";
        if (t == 86 || t == 87) return "\u5feb\u6377\u652f\u4ed8";
        if (t == 83 && m == "UNIONPAY_UNIONPAY") return "\u94f6\u8054\u5728\u7ebf\u652f\u4ed8";
        if (t == 83 && m == "HUAWEIPAY_HUAWEIPAY") return "\u94f6\u8054\u4e91\u95ea\u4ed8\uff08Huawei Pay\uff09";
        if (t - 1 > 9) return "\u5728\u7ebf\u652f\u4ed8";
        return paymentType[t - 1]
    };
    if ($("#checkid").val() != "nocomment") productList = lst.productInfoList || []; else productList = lst.productList || [];
    isRefund = lst.isRefund;
    if (lst.paymentStatus == 3) code = "\u652f\u4ed8\u4f59\u6b3e";
    var rowspanValue = 0;
    rowspanValue += productList.length;
    for (var i = 0; i < productList.length; i++) {
        var productInfo = productList[i];
        if (productInfo.subOrderProductInfoList != undefined && productInfo.subOrderProductInfoList.length > 0) rowspanValue += productInfo.subOrderProductInfoList.length;
        if (productInfo.productCouponList != undefined) rowspanValue += productInfo.productCouponList.length;
        if (lst.couponList != undefined) rowspanValue += lst.couponList.length
    }
    for (var i = 0; i < productList.length; i++) {
        var productInfo = productList[i];
        html.push('\x3ctr\x3e\x3ctd class\x3d"col-pro-img"\x3e\x3cp class\x3d"p-img"\x3e');
        html.push('\x3ca title\x3d"' + productInfo.skuName + '" href\x3d"/product/' + productInfo.productId + ".html#" + productInfo.skuId + '" target\x3d"_blank" onclick\x3d"pushProMsg(' + ec.encodeForJS(productInfo.skuId) + ",'300130101')\"\x3e");
        if (productInfo.photoPath) html.push('\x3cimg class\x3d"nocomment-' + productInfo.skuCode + '" alt\x3d"' + productInfo.skuName + '" src\x3d"' + ec.mediaPath + productInfo.photoPath + "100_100_" + productInfo.photoName + '"/\x3e'); else html.push('\x3cimg class\x3d"nocomment-' + productInfo.skuCode + '" alt\x3d"" src\x3d""/\x3e');
        html.push('\x3c/a\x3e\x3c/p\x3e\x3c/td\x3e\x3ctd class\x3d"col-pro-info"\x3e\x3cp class\x3d"p-name"\x3e');
        if (productInfo.itemType == "B" || productInfo.productType == "P") if (lst.type == 3) ; else html.push("\x3cb\x3e\u5957\u9910\u5546\u54c1\x3c/b\x3e");
        html.push('\x3ca title\x3d"' + productInfo.skuName + '" target\x3d"_blank" ');
        html.push('class\x3d"nocomment-' + productInfo.skuCode + '"href\x3d"/product/' + productInfo.productId + ".html#" + productInfo.skuId + '" onclick\x3d"pushProMsg(' + ec.encodeForJS(productInfo.skuId) + ",'300130101')\"\x3e" + ec.autoEncodeAttr(productInfo.skuName) + "\x3c/a\x3e");
        html.push('\x3c/p\x3e\x3c/td\x3e\x3ctd class\x3d"col-price"\x3e');
        if ((lst.type == 10 || lst.type == 18) && (productInfo.productType == 4 || productInfo.productType == "DE") && lst.balanceAmount == null) {
            html.push("\x3cspan\x3e");
            html.push("\u6682\u65e0\u62a5\u4ef7")
        } else {
            html.push("\x3cem\x3e\x26yen;\x3c/em\x3e\x3cspan\x3e");
            html.push((productInfo.unitPrice || 0).toFixed(2))
        }
        html.push('\x3c/span\x3e\x3c/td\x3e\x3ctd class\x3d"col-quty"\x3e');
        html.push(productInfo.quantity + "\x3c/td\x3e");
        if (i == 0) {
            html.push('\x3ctd rowspan\x3d"' + rowspanValue + '" class\x3d"col-pay"\x3e');
            if (lst.paymentAmountTotal) html.push("\x3cp\x3e\x3cem\x3e\x26yen;\x3c/em\x3e\x3cspan\x3e"); else html.push("\x3cp\x3e\x3cspan\x3e");
            if (lst.type == 10 || lst.type == 18) if (lst.paymentAmountTotal) html.push(lst.paymentAmountTotal > 0 ? lst.paymentAmountTotal.toFixed(2) : 0 + "\x3c/span\x3e\x3c/p\x3e"); else html.push("--\x3c/span\x3e\x3c/p\x3e"); else if (lst.realPaymentAmountTotal) html.push(lst.realPaymentAmountTotal.toFixed(2) + "\x3c/span\x3e\x3c/p\x3e"); else html.push(lst.paymentAmountTotal.toFixed(2) + "\x3c/span\x3e\x3c/p\x3e");
            if (paymentList.length > 0) html.push("\x3cp\x3e\x3cem\x3e" + _showPaymentText(paymentType_, paymentMethod_) + "\x3c/em\x3e\x3c/p\x3e");
            html.push("\x3c/td\x3e")
        }
        if (i == 0 && (lst.orderStatus < 5 || lst.orderStatus > 7)) {
            html.push('\x3ctd rowspan\x3d"' + rowspanValue + '" class\x3d"col-operate"\x3e');
            if (lst.orderStatus == 3 && lst.paymentStatus == 1 || lst.orderStatus == 9) if (lst.type == 0 || lst.type == 5 || lst.type == 10 || lst.type == 17 || lst.type == 18) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d\'ec.member.orderList.remind("' + lst.orderCode + '","' + lst.orderStatus + '","' + lst.logisticsName + '","' + lst.logisticsNumbers + '","' + lst.shippingDate + "\");'\x3e\u6211\u8981\u50ac\u5355\x3c/a\x3e\x3c/p\x3e");
            if (lst.orderStatus == 8 || lst.orderStatus == 16 || lst.orderStatus == 17) ; else if (lst.orderStatus == 4) {
                if (lst.type == 19 && lst.orderStatus != 14 && lst.orderStatus != 11) {
                    html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/updateToOrder\', {orderCode: \'' + ec.encodeForJS(lst.orderCode) + "'})\"\x3e\u4fee\u6539\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e");
                    html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" data-ordercode\x3d"' + lst.orderCode + '" onclick\x3d"ec.member.orderList.cancel(this, ' + lst.paymentStatus + "," + lst.type + "," + lst.unionPayAmountTotal + ');"\x3e\u53d6\u6d88\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e')
                }
            } else if (lst.orderStatus == 12) ; else if (lst.type && lst.type == 3) {
                if (lst.orderStatus == 1 || lst.orderStatus == 3 || lst.orderStatus == 9 && ec.member.orderList.updateDeliveryOrder == "1" && lst.shopCode == "VMALL-HUAWEIDEVICE") if (lst.originalType != 14 && lst.originalType != 28 && lst.originalType != 35) if (lst.orderStatus == 9 && lst.isSelfPickup == 1) ; else html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/updateToOrder\', {orderCode: \'' + ec.encodeForJS(lst.orderCode) + "'})\"\x3e\u4fee\u6539\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e")
            } else if (dataType == 0 || lst.isHisData != 1) {
                if (lst.payFlag && lst.payFlag == 1) if (lst.type == 10 || lst.type == 18) {
                    var isPass = (lst.paymentStatus == 2 || lst.paymentAmountTotal < lst.depositAmount) && 2 != lst.isBalancePayStart;
                    if (isPass) html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay" onclick\x3d"ec.postTo(\'/payment/orderNew\', {orderCode: \'' + lst.orderCode + '\'})" href\x3d"javascript:;"\x3e\x3cspan\x3e\u652f\u4ed8\u8ba2\u91d1\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e'); else if (lst.paymentStatus == 3 && lst.isBalancePayStart == 0) if (0 != lst.cashPay) if (lst.type == 10) {
                        html.push('\x3cinput type\x3d"hidden" id\x3d"subStatus_' + lst.orderCode + ' value\x3d"' + lst.subStatus + '"/\x3e');
                        html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay" href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/order/payment/final\', {orderCode: \'' + ec.encodeForJS(lst.orderCode) + "', type: '" + ec.encodeForJS(lst.type) + "'})\"\x3e\x3cspan\x3e\u652f\u4ed8\u5c3e\u6b3e\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e")
                    } else html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay" onclick\x3d"ec.postTo(\'/payment/orderNew\', {orderCode: \'' + lst.orderCode + '\'})" href\x3d"javascript:;"\x3e\x3cspan\x3e\u652f\u4ed8\u5c3e\u6b3e\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e'); else html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay-disabled" href\x3d"javascript:;"\x3e\x3cspan\x3e\u7b49\u5f85\u5c3e\u6b3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e'); else if (lst.paymentStatus == 3 && lst.isBalancePayStart == 1 || lst.isBalancePayStart == 4) html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay-disabled" href\x3d"javascript:;"\x3e\x3cspan\x3e\u7b49\u5f85\u652f\u4ed8\u5c3e\u6b3e\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e'); else if ((lst.paymentStatus == 2 || lst.paymentStatus == 3) && lst.isBalancePayStart == 2) html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay-disabled" href\x3d"javascript:;"\x3e\x3cspan\x3e\u652f\u4ed8\u65f6\u95f4\u5df2\u8fc7\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e')
                } else {
                    html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-pay" onclick\x3d"ec.postTo(\'/payment/orderNew\', {orderCode: \'' + lst.orderCode + '\'})" href\x3d"javascript:;"\x3e\x3cspan\x3e');
                    html.push(code);
                    html.push("\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e")
                }
                if (lst.type != 14 && lst.type != 28) {
                    if (lst.orderStatus != 14) if (lst.orderStatus != 11) if (lst.type == 36 && lst.paymentStatus == 1) ; else if (lst.orderStatus == 9 && (ec.member.orderList.updateDeliveryOrder == "0" || lst.shopCode != "VMALL-HUAWEIDEVICE" || (lst.type == 5 || lst.type == 10 || lst.type == 17 || lst.type == 18 || lst.type == 26) && lst.canModifyOrder == "0")) ; else if (lst.orderStatus == 9 && lst.isSelfPickup == 1) ; else html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/updateToOrder\', {orderCode: \'' + ec.encodeForJS(lst.orderCode) + "'})\"\x3e\u4fee\u6539\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e");
                    if (lst.type != 3 && lst.type != 17 && lst.orderStatus != 14 || lst.orderStatus == 9) if ((lst.type == 9 || lst.type == 25 || lst.type == 19) && lst.orderStatus == 9) ; else if (lst.orderStatus != 11) if (lst.paymentStatus == 1 && lst.orderStatus == 1 && (lst.type == 33 || lst.type == 39)) ; else if (lst.paymentStatus == 1 && lst.type == 35) ; else html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" data-ordercode\x3d"' + lst.orderCode + '" onclick\x3d"ec.member.orderList.cancel(this, ' + lst.paymentStatus + "," + lst.type + "," + lst.unionPayAmountTotal + ');"\x3e\u53d6\u6d88\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e')
                } else if (lst.type == 28) {
                    if (lst.orderStatus < 7) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" data-ordercode\x3d"' + lst.orderCode + '" onclick\x3d"ec.member.orderList.cancel(this, ' + lst.paymentStatus + "," + lst.type + "," + lst.unionPayAmountTotal + ');"\x3e\u53d6\u6d88\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e')
                } else if (lst.orderStatus < 7) {
                    html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/updateToOrder\', {orderCode: \'' + ec.encodeForJS(lst.orderCode) + "'})\"\x3e\u4fee\u6539\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e");
                    if (lst.paymentStatus == 2 && lst.orderStatus != 11) if (lst.type != 3) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" data-ordercode\x3d"' + lst.orderCode + '" onclick\x3d"ec.member.orderList.cancel(this, ' + lst.paymentStatus + "," + lst.type + "," + lst.unionPayAmountTotal + ');"\x3e\u53d6\u6d88\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e')
                }
            }
            if (lst.orderStatus == 8 && lst.canceledOrderDelPermission || lst.orderStatus == 7 && (lst.timeDifference >= 32 || ec.member.orderList.GetDateDiff(lst.updateDate) >= 32)) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.member.orderList.del(this,\'' + ec.encodeForJS(lst.orderCode) + "');\"\x3e\u5220\u9664\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e");
            html.push("\x3cp class\x3d\"p-link\"\x3e\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + lst.orderCode + "', isHisData: '" + isHisData + '\'});" href\x3d"javascript:;"\x3e\u8ba2\u5355\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');
            if (lst.isRefund == 1) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/refund\',{orderCode:' + ec.encodeForJS(lst.orderCode) + ",isLive:" + ec.encodeForJS(isHisData) + '});"\x3e\u9000\u6b3e\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');
            html.push("\x3c/td\x3e")
        }
        if (lst.orderStatus >= 5 && lst.orderStatus <= 7) if (i == 0) {
            html.push('\x3ctd rowspan\x3d"' + rowspanValue + '" class\x3d"col-operate"\x3e');
            if (lst.orderStatus == 5 || lst.orderStatus == 6) {
                if (lst.type == 0 || lst.type == 5 || lst.type == 10 || lst.type == 17 || lst.type == 18) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d\'ec.member.orderList.remind("' + lst.orderCode + '","' + lst.orderStatus + '","' + lst.logisticsName + '","' + lst.logisticsNumbers + '","' + lst.shippingDate + "\")';\x3e\u6211\u8981\u50ac\u5355\x3c/a\x3e\x3c/p\x3e");
                if (lst.isSelfPickup == 1 && lst.orderStatus == 5) {
                    html.push('\x3cp class\x3d"p-button"\x3e\x3ca class\x3d"button-operate-revie" href\x3d"javascript:;" onclick\x3d"ec.member.orderList.lookSelfExtractingCode(' + ec.encodeForJS(lst.orderCode) + ')"\x3e\x3cspan\x3e\u67e5\u770b\u81ea\u63d0\u7801\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e');
                    if (lst.type != 3) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" data-ordercode\x3d"' + lst.orderCode + '" onclick\x3d"ec.member.orderList.cancel(this, ' + lst.paymentStatus + "," + lst.type + "," + lst.unionPayAmountTotal + "," + lst.isSelfPickup + ');"\x3e\u53d6\u6d88\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e')
                }
            }
            if (lst.shopCode == "VMALL-HUAWEIDEVICE" && lst.orderStatus == 6) ;
            if (!productInfo.remarkId && lst.orderStatus == 7) if (productInfo.productId) html.push('\x3cp class\x3d"p-button hide"\x3e\x3ca class\x3d"button-operate-revie pl-' + productInfo.skuCode + '" href\x3d"javascript:;" orderInfo\x3d"' + lst.orderCode + '"\x3e\x3cspan\x3e\u6211\u8981\u8bc4\u8bba\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e'); else html.push('\x3cp class\x3d"p-button hide"\x3e\x3ca class\x3d"button-operate-revie pl-' + productInfo.skuCode + '" href\x3d"javascript:;" orderInfo\x3d"' + lst.orderCode + '"\x3e\x3cspan\x3e\u6211\u8981\u8bc4\u8bba\x3c/span\x3e\x3c/a\x3e\x3c/p\x3e');
            var isPass = productInfo.productType != 2 && lst.type != 12 && lst.type != 14 && lst.type != 28 && lst.type != 36 && lst.type != 3 && lst.type != 9 && lst.type != 19 && lst.orderStatus == 7;
            if (dataType == 0) if (lst.orderStatus == 7 && (lst.timeDifference >= 32 || ec.member.orderList.GetDateDiff(lst.updateDate) >= 32)) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.member.orderList.del(this,\'' + ec.encodeForJS(lst.orderCode) + "');\"\x3e\u5220\u9664\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e"); else {
                if (isPass) if (lst.type == 35 && lst.paymentStatus == 1) ; else if (lst.rmaFlag == 1 || lst.rmaFlag == 2) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.member.orderList.exchangeTip(this,' + ec.encodeForJS(lst.orderCode) + ')"\x3e\u9000\u6362\u8d27\x3c/a\x3e\x3c/p\x3e')
            } else if (lst.orderStatus == 7 && (lst.timeDifference >= 32 || ec.member.orderList.GetDateDiff(lst.updateDate) >= 32)) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.member.orderList.del(this,\'' + ec.encodeForJS(lst.orderCode) + "');\"\x3e\u5220\u9664\u8ba2\u5355\x3c/a\x3e\x3c/p\x3e"); else if (isPass) if (lst.type == 35 && lst.paymentStatus == 1) ; else if (lst.rmaFlag == 1 || lst.rmaFlag == 2) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.member.orderList.exchangeTip(this,' + ec.encodeForJS(lst.orderCode) + ')"\x3e\u9000\u6362\u8d27\x3c/a\x3e\x3c/p\x3e');
            html.push("\x3cp class\x3d\"p-link\"\x3e\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + lst.orderCode + "', isHisData: '" + isHisData + "'});\"\x3e\u8ba2\u5355\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e");
            if (lst.isRefund == 1) html.push('\x3cp class\x3d"p-link"\x3e\x3ca href\x3d"javascript:;" onclick\x3d"ec.postTo(\'/member/refund\',{orderCode:' + ec.encodeForJS(lst.orderCode) + ",isLive:" + ec.encodeForJS(isHisData) + '});"\x3e\u9000\u6b3e\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e');
            html.push("\x3c/td\x3e")
        }
        html.push("\x3c/tr\x3e");
        var packFlag = false;
        var productCouponStr = "";
        if (productInfo.productCouponList != undefined && productInfo.productCouponList.length > 0) for (var productii = 0; productii < productInfo.productCouponList.length; productii++) {
            productCouponStr += '\x3ctr class\x3d"o-gift"\x3e';
            productCouponStr += '\x3ctd class\x3d"col-gift" colspan\x3d"2"\x3e';
            productCouponStr += '\x3cp class\x3d"d-name"\x3e\x3cb\x3e\u8d60\u54c1\x3c/b\x3e' + productInfo.productCouponList[productii].couponName + "\x3c/p\x3e";
            productCouponStr += "\x3c/td\x3e";
            productCouponStr += '\x3ctd class\x3d"col-price"\x3e--\x3c/td\x3e';
            productCouponStr += '\x3ctd class\x3d"col-quty"\x3e' + productInfo.productCouponList[productii].quantity + "\x3c/td\x3e";
            productCouponStr += "\x3c/tr\x3e"
        }
        var countNum = 0;
        if (productInfo.subOrderProductInfoList != undefined && productInfo.subOrderProductInfoList.length > 0) for (var k = 0; k < productInfo.subOrderProductInfoList.length; k++) {
            var subProductInfo = productInfo.subOrderProductInfoList[k];
            if (countNum == 0 && (subProductInfo.itemType == "B" || subProductInfo.productType == "P")) {
                html.push(productCouponStr);
                packFlag == true;
                countNum++
            }
            html.push('\x3ctr\x3e\x3ctd class\x3d"col-pro-img"\x3e\x3cp class\x3d"p-img"\x3e');
            html.push('\x3ca title\x3d"' + subProductInfo.skuName + '" href\x3d"/product/' + subProductInfo.productId + ".html#" + subProductInfo.skuId + '" target\x3d"_blank" onclick\x3d"pushProMsg(' + ec.encodeForJS(subProductInfo.skuId) + ",'300130101')\"\x3e");
            if (subProductInfo.photoPath) html.push('\x3cimg class\x3d"nocomment-' + subProductInfo.skuCode + '" alt\x3d"' + subProductInfo.skuName + '" src\x3d"' + ec.mediaPath + subProductInfo.photoPath + "100_100_" + subProductInfo.photoName + '"/\x3e'); else html.push('\x3cimg class\x3d"nocomment-' + subProductInfo.skuCode + '" alt\x3d"" src\x3d""/\x3e');
            html.push("\x3c/a\x3e\x3c/p\x3e");
            html.push("\x3c/td\x3e");
            html.push('\x3ctd class\x3d"col-pro-info"\x3e\x3cp class\x3d"p-name"\x3e');
            if (lst.type == 3) ; else {
                if (subProductInfo.itemType == "B" || subProductInfo.productType == "P") html.push("\x3cb\x3e\u5957\u9910\u5546\u54c1\x3c/b\x3e");
                if (subProductInfo.itemType == "G") html.push("\x3cb\x3e\u914d\x3c/b\x3e");
                if (subProductInfo.productType == "DP") html.push("\x3cb\x3e\u642d\u914d\x3c/b\x3e")
            }
            html.push('\x3ca title\x3d"' + subProductInfo.skuName + '" target\x3d"_blank" ');
            html.push('class\x3d"nocomment-' + subProductInfo.skuCode + '"href\x3d"/product/' + subProductInfo.productId + ".html#" + subProductInfo.skuId + '" onclick\x3d"pushProMsg(' + ec.encodeForJS(subProductInfo.skuId) + ",'300130101')\"\x3e" + ec.autoEncodeAttr(subProductInfo.skuName) + "\x3c/a\x3e");
            html.push('\x3c/p\x3e\x3c/td\x3e\x3ctd class\x3d"col-price"\x3e');
            if ((lst.type == 10 || lst.type == 18) && (subProductInfo.productType == 4 || productInfo.productType == "DE") && lst.balanceAmount == null) {
                html.push("\x3cspan\x3e");
                html.push("\u6682\u65e0\u62a5\u4ef7")
            } else {
                html.push("\x3cem\x3e\x26yen;\x3c/em\x3e\x3cspan\x3e");
                html.push((subProductInfo.unitPrice || 0).toFixed(2))
            }
            html.push('\x3c/span\x3e\x3c/td\x3e\x3ctd class\x3d"col-quty"\x3e');
            html.push(subProductInfo.quantity + "\x3c/td\x3e");
            html.push("\x3c/tr\x3e")
        }
        if (!packFlag && countNum == 0 && productInfo.productCouponList != null && productInfo.productCouponList.length > 0) {
            for (var producti = 0; producti < productInfo.productCouponList.length; producti++) {
                html.push('\x3ctr class\x3d"o-gift"\x3e');
                html.push('\x3ctd class\x3d"col-gift" colspan\x3d"2"\x3e');
                html.push('\x3cp class\x3d"d-name"\x3e\x3cb\x3e\u8d60\u54c1\x3c/b\x3e' + productInfo.productCouponList[producti].couponName + "\x3c/p\x3e");
                html.push("\x3c/td\x3e");
                html.push('\x3ctd class\x3d"col-price"\x3e--\x3c/td\x3e');
                html.push('\x3ctd class\x3d"col-quty"\x3e' + productInfo.productCouponList[producti].quantity + "\x3c/td\x3e");
                html.push("\x3c/tr\x3e")
            }
            countNum++
        }
        if (lst.couponList != null && lst.couponList.length > 0 && i == productList.length - 1) for (var j = 0; j < lst.couponList.length; j++) {
            html.push('\x3ctr class\x3d"o-gift"\x3e');
            html.push('\x3ctd class\x3d"col-gift" colspan\x3d"2"\x3e');
            html.push('\x3cp class\x3d"d-name"\x3e\x3cb\x3e\u8ba2\u5355\u8d60\x3c/b\x3e' + lst.couponList[j].couponName + "\x3c/p\x3e");
            html.push("\x3c/td\x3e");
            html.push('\x3ctd class\x3d"col-price"\x3e--\x3c/td\x3e');
            html.push('\x3ctd class\x3d"col-quty"\x3e' + lst.couponList[j].quantity + "\x3c/td\x3e");
            html.push("\x3c/tr\x3e")
        }
    }
    return html.join("")
};
ec.member.orderList.skuList = function (skus) {
    var html = [];
    if (skus != null && skus.length > 0) for (var i = 0; i < skus.length; i += 1) html.push("\x3cem\x3e" + skus[i] + "\x3c/em\x3e");
    return html.join("")
};
ec.member.orderList.depositList = function (lst) {
    var html = [];
    html.push('\x3cdiv class\x3d"o-deposit"\x3e');
    html.push('\x3ctable border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e');
    html.push('\x3ctbody\x3e\x3ctr\x3e\x3ctd class\x3d"col-deposit"\x3e\x3cp class\x3d"d-name"\x3e\u9636\u6bb51\uff1a\u8ba2\u91d1\x3c/p\x3e\x3c/td\x3e');
    html.push('\x3ctd class\x3d"col-price"\x3e\x3cem\x3e\u00a5\x3c/em\x3e\x3cspan\x3e' + lst.depositAmount.toFixed(2) + "\x3c/span\x3e\x3c/td\x3e");
    html.push('\x3ctd class\x3d"col-quty"\x3e-\x3c/td\x3e');
    if (lst.paymentStatus == 2) {
        html.push('\x3ctd class\x3d"col-pay"\x3e\x3cspan\x3e--\x3c/span\x3e\x3c/td\x3e');
        html.push('\x3ctd class\x3d"col-operate"\x3e\u5f85\u652f\u4ed8\x3c/td\x3e')
    } else if (lst.paymentStatus == 3) if (lst.paymentAmountTotal >= lst.depositAmount) {
        html.push('\x3ctd class\x3d"col-pay"\x3e\x3cem\x3e\u00a5\x3c/em\x3e\x3cspan\x3e' + lst.depositAmount.toFixed(2) + "\x3c/span\x3e\x3c/td\x3e");
        html.push('\x3ctd class\x3d"col-operate"\x3e\u5df2\u652f\u4ed8\x3c/td\x3e')
    } else {
        if (lst.paymentAmountTotal < lst.depositAmount && lst.paymentAmountTotal > 0) {
            html.push('\x3ctd class\x3d"col-pay"\x3e\x3cem\x3e\u00a5\x3c/em\x3e\x3cspan\x3e' + lst.paymentAmountTotal.toFixed(2) + "\x3c/span\x3e\x3c/td\x3e");
            html.push('\x3ctd class\x3d"col-operate"\x3e\u90e8\u5206\u652f\u4ed8\u8ba2\u91d1\x3c/td\x3e')
        }
    } else {
        html.push('\x3ctd class\x3d"col-pay"\x3e\x3cem\x3e\u00a5\x3c/em\x3e\x3cspan\x3e' + lst.depositAmount.toFixed(2) + "\x3c/span\x3e\x3c/td\x3e");
        html.push('\x3ctd class\x3d"col-operate"\x3e\u5df2\u652f\u4ed8\x3c/td\x3e')
    }
    html.push('\x3c/tr\x3e\x3ctr class\x3d"disabled"\x3e');
    if (lst.balanceStartTime != "" && lst.balanceStartTime != null) html.push('\x3ctd class\x3d"col-deposit"\x3e\u9636\u6bb52\uff1a\u5c3e\u6b3e(' + lst.balanceStartTime + "\u81f3" + lst.balanceEndTime + "\u652f\u4ed8" + ")\x3c/td\x3e"); else html.push('\x3ctd class\x3d"col-deposit"\x3e\u9636\u6bb52\uff1a\u5c3e\u6b3e(\u6682\u65f6\u65e0\u6cd5\u83b7\u53d6\u5c3e\u6b3e\u652f\u4ed8\u65f6\u95f4\uff0c\u8bf7\u60a8\u7a0d\u540e\u518d\u8bd5\u8bd5)');
    html.push('\x3ctd class\x3d"col-price"\x3e');
    if (null != lst.balanceAmount) {
        html.push("\x3cem\x3e\u00a5\x3c/em\x3e\x3cspan\x3e");
        html.push(lst.balanceAmount > 0 ? lst.balanceAmount.toFixed(2) : 0)
    } else {
        html.push("\x3cspan\x3e");
        html.push("\u6682\u65e0\u62a5\u4ef7")
    }
    html.push("\x3c/span\x3e\x3c/td\x3e");
    html.push('\x3ctd class\x3d"col-quty"\x3e-\x3c/td\x3e');
    html.push('\x3ctd class\x3d"col-pay"\x3e');
    if (null != lst.balancePay) {
        html.push("\x3cem\x3e\u00a5\x3c/em\x3e\x3cspan\x3e");
        html.push(lst.balancePay > 0 ? lst.balancePay.toFixed(2) : 0)
    } else {
        html.push("\x3cspan\x3e");
        html.push("--")
    }
    html.push("\x3c/span\x3e\x3c/td\x3e");
    if (lst.paymentStatus == 1) html.push('\x3ctd class\x3d"col-operate"\x3e\u5df2\u652f\u4ed8\x3c/td\x3e'); else if (lst.paymentStatus == 2 && lst.isBalancePayStart == 0) html.push('\x3ctd class\x3d"col-operate"\x3e\u5f85\u652f\u4ed8\x3c/td\x3e'); else if (lst.isBalancePayStart == 0) if (lst.paymentAmountTotal <= lst.depositAmount) html.push('\x3ctd class\x3d"col-operate"\x3e\u5f85\u652f\u4ed8\x3c/td\x3e'); else if (lst.paymentAmountTotal < lst.cashPay && lst.paymentAmountTotal > lst.depositAmount) html.push('\x3ctd class\x3d"col-operate"\x3e\u90e8\u5206\u652f\u4ed8\u5c3e\u6b3e\x3c/td\x3e'); else {
        if (lst.paymentAmountTotal == lst.cashPay) html.push('\x3ctd class\x3d"col-operate"\x3e\u5df2\u652f\u4ed8\x3c/td\x3e')
    } else if (lst.isBalancePayStart == 1) html.push('\x3ctd class\x3d"col-operate"\x3e\u652f\u4ed8\u65f6\u95f4\u672a\u5230\x3c/td\x3e'); else if (lst.isBalancePayStart == 4) html.push('\x3ctd class\x3d"col-operate"\x3e\x3c/td\x3e'); else if (lst.isBalancePayStart == 2) html.push('\x3ctd class\x3d"col-operate"\x3e\u652f\u4ed8\u671f\u5df2\u8fc7\x3c/td\x3e');
    html.push("\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e");
    return html.join("")
};
ec.member.orderList.exchangeTip = function (obj, orderCode) {
    $.ajax({
        type: "POST",
        url: "/member/exchange/getReturnExchangeFlag.json",
        data: {"orderCode": orderCode, isLive: $("#colid").val()},
        async: false,
        dataType: "json",
        success: function (json) {
            if (null != json && json.success) {
                var returnExchangeFlag = json.returnExchangeFlag;
                if (returnExchangeFlag == 0) (new ec.box($("#exchange-timeout").val(), {
                    boxclass: "ol_box_4",
                    autoHeight: false,
                    showButton: false
                })).open(); else if (returnExchangeFlag == "35210") (new ec.box($("#exchange-error").val(), {
                    boxclass: "ol_box_4",
                    autoHeight: false,
                    showButton: false
                })).open(); else (new ec.box($("#exchange-agreement").val(), {
                    boxclass: "ol_box_4 ol_box_title",
                    title: "\u9000\u6362\u8d27\u529e\u7406\u534f\u8bae",
                    width: 700,
                    autoHeight: false,
                    onok: function () {
                        ec.postTo("/member/exchange/get", {
                            orderCode: orderCode,
                            returnExchangeFlag: returnExchangeFlag
                        })
                    }
                })).open()
            } else {
                alert("\u83b7\u53d6\u8bf7\u6c42\u5931\u8d25");
                return false
            }
        }
    })
};
ec.member.orderList.del = function (dom, orderCode) {
    var msg = '\x3cspan style\x3d"font-size:16px;"\x3e\u786e\u8ba4\u5220\u9664\u6b64\u8ba2\u5355?\x3c/span\x3e\x3cbr/\x3e\x3cspan style\x3d"font-size:14px;color:#333;"\x3e\u8ba2\u5355\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d,\u8bf7\u8c28\u614e\u64cd\u4f5c!\x3c/span\x3e';
    if (ec.ui.confirm(dom, msg)) $.ajax({
        type: "post",
        url: "/member/order/del.json",
        data: {orderCode: orderCode, "isLive": $("#colid").val()},
        dataType: "json",
        timeout: 1E4,
        beforeSend: function (xhr) {
            ec.ui.loading.show({modal: false})
        },
        success: function (json) {
            ec.ui.loading.hide();
            var msg = "";
            var msgHtml = '\x3cdiv class\x3d"box-right-1"\x3e\x3cspan id\x3d"prompt-delorder"\x3e\u6e29\u99a8\u63d0\u793a\uff1a\u8ba2\u5355\u5220\u9664\u6210\u529f\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"box-button"\x3e\x3ca class\x3d"box-ok box-button-style-1" href\x3d"javascript:;"\x3e\x3cspan\x3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e';
            if (!json.success) {
                var msg = "\u767b\u5f55\u5df2\u8d85\u65f6,\u8bf7\u91cd\u65b0\u767b\u5f55";
                if (json.code != "login") msg = json.msg;
                msgHtml = '\x3cdiv class\x3d"box-prompt-error-area"\x3e\x3cdiv class\x3d"h"\x3e\x3ci\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"b"\x3e\x3cspan id\x3d"prompt-delorder" style\x3d"color:#3a3a3a;"\x3e' + msg + '\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"box-custom-button"\x3e\x3ca class\x3d"box-ok box-button-style-1" href\x3d"javascript:;"\x3e\x3cspan\x3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e'
            }
            (new ec.box(msgHtml, {
                "boxclass": "ol_box_4 small",
                "boxid": "orderDelBox",
                "title": "",
                "modal": true,
                "showButton": false,
                "onok": function (box) {
                    if (json.code != "login") ec.redirectTo("/member/order?t\x3d" + (new Date).getTime());
                    box.close()
                },
                "onclose": function (box) {
                    if (json.code != "login") ec.redirectTo("/member/order?t\x3d" + (new Date).getTime())
                }
            })).open()
        },
        error: function () {
            // alert("\u8bfb\u53d6\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01")
        }
    })
};
var _del;
ec.member.orderList.cancel = function (dom, t, type, unionPayAmountTotal, isSelfPickup) {
    var $cancelBox = $("\x3cdiv\x3e\x3c/div\x3e").append($("#order-cancel").val());
    $("#cancelReson").val("");
    var orderCode = $(dom).attr("data-ordercode");
    var unionPayTips = document.getElementById("unionPayTips");
    if (unionPayTips) unionPayTips.remove();
    if (unionPayAmountTotal > 0) $cancelBox.find(".order-cancel-tips ul").append('\x3cli id\x3d"unionPayTips"\x3e*\x26nbsp;\x26nbsp;' + "\u672c\u8ba2\u5355\u4eab\u53d7\u7b2c\u4e09\u65b9\u652f\u4ed8\u5e73\u53f0\u652f\u4ed8\u7acb\u51cf\u4f18\u60e0\u91d1\u989d" + parseFloat(unionPayAmountTotal).toFixed(2) + "\u5143\uff0c\u8ba2\u5355\u53d6\u6d88\u540e\u8be5\u7b14\u4f18\u60e0\u91d1\u989d\u4f1a\u8fd4\u8fd8\u81f3\u652f\u4ed8\u5e73\u53f0\uff0c\u4e0d\u4f1a\u8fd4\u8fd8\u81f3\u60a8\u7684\u4e2a\u4eba\u652f\u4ed8\u8d26\u6237\u3002\x3c/li\x3e");
    _del = function (box) {
        if (box) box.close();
        ec.loadCsrfToken(function () {
            $.ajax({
                type: "post",
                url: "/member/cancelOrder",
                data: {"orderCode": orderCode, "isSelfPickup": isSelfPickup, "cancelReson": $("#cancelReson").val()},
                dataType: "json",
                timeout: 1E4,
                beforeSend: function (xhr) {
                    xhr.withCredentials = true;
                    ec.ui.loading.show({modal: false})
                },
                success: function (json) {
                    ec.ui.loading.hide();
                    if (!json.success) {
                        ec.showError(json);
                        return
                    }
                    var html = [], p = json.order;
                    var myOrdersProArea = $(dom).closest("td").html("\x3cp class\x3d\"p-link\"\x3e\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + p.code + '\'});" href\x3d"javascript:;"\x3e\u8ba2\u5355\u8be6\u60c5\x3c/a\x3e\x3c/p\x3e').closest(".list-group-item");
                    var tbody = myOrdersProArea.find(".o-info");
                    var payAndCancel = "\u5df2\u53d6\u6d88";
                    if (json.orderStatus == 16) payAndCancel = "\u53d6\u6d88\u5904\u7406\u4e2d";
                    if (p.paymentStatus == "1") payAndCancel += "\x26nbsp;|\x26nbsp;\u5df2\u4ed8\u6b3e";
                    tbody.find(".col-state").html(payAndCancel);
                    html.push('\x3cdiv class\x3d"col-info"\x3e');
                    if (p.type != 10 && p.type != 18 && (p.paymentStatus == 2 || p.paymentStatus == 3) && (p.orderStatus == 3 || p.orderStatus < 3 && p.orderSource != 2)) html.push('\x3cinput type\x3d"checkbox" class\x3d"checkbox" name\x3d"payCheck" paymentStatus\x3d"' + p.paymentStatus + '"' + 'clearOrder\x3d"' + tempClearingTips + '" value\x3d"' + p.orderCode + '"/\x3e');
                    html.push('\x3cspan class\x3d"o-date"\x3e');
                    html.push(ec.util.parseDate(p.orderDate).format("yyyy-MM-dd HH:mm"));
                    html.push('\x3c/span\x3e\x3cspan class\x3d"o-no"\x3e');
                    html.push("\u8ba2\u5355\u53f7\uff1a\x3ca onclick\x3d\"ec.postTo('/member/order/detail', {orderCode:'" + p.code + '\'});" href\x3d"javascript:;" title\x3d"' + p.code + '"\x3e' + p.code + "\x3c/a\x3e\x3c/span\x3e");
                    if (p.type == 33 || p.type == 39) html.push('\x3cspan class\x3d"o-icon-1"\x3e\u62fc\u8d2d\x3c/span\x3e');
                    if (p.type == 26) html.push('\x3cspan class\x3d"icon-priority"\x3e\x3c/span\x3e');
                    html.push('\x3c/div\x3e\x3cdiv class\x3d"col-state"\x3e' + payAndCancel + "\x3c/div\x3e\x3c/div\x3e");
                    tbody.html(html.join(""));
                    ec.member.orderList.orderCount();
                    ec.member.orderList.box = (new ec.box($("#cancel-msg-tpl").val(), {
                        "boxclass": "ol_box_4",
                        "title": "\u8ba2\u5355\u53d6\u6d88\u7533\u8bf7\u5df2\u63d0\u4ea4",
                        "showButton": false,
                        "onok": function (box) {
                            box.close()
                        }
                    })).open();
                    return
                },
                error: function () {
                    ec.ui.loading.hide()
                }
            })
        })
    };
    ec.member.orderList.box = (new ec.box($cancelBox, {
        "boxclass": "ol_box_4",
        "title": "\u8ba2\u5355\u53d6\u6d88\u7533\u8bf7",
        "boxid": "orderDelBox",
        "width": 700,
        "modal": true,
        "showButton": false
    })).open();
    ec.member.orderList.orderCount()
};
ec.member.orderList.seltime = function (dom, col) {
    if ($(dom).parent("li").hasClass("current")) return;
    $("#colid").valS(col);
    $("#checkid").val("all");
    $("#myOrder-cate li").removeClass("current");
    $("#myOrder-cate li:first").addClass("current");
    $(dom).parent("li").addClass("current").siblings().removeClass("current");
    var pamar = {"pageNumber": 1}, dataNum2 = $("#count-seltime-2").attr("data-num"),
        dataNum3 = $("#count-seltime-3").attr("data-num"), nocommentNum = $("#nocommentNum").attr("data-num"),
        hisnocommentNum = $("#nocommentNum").attr("data-his");
    ec.member.orderList.load(pamar, col);
    if (col == 0) {
        $("#nocommentNum").parents("li").hide();
        $("#nocommentNum").textS(hisnocommentNum);
        if (hisnocommentNum > 0) $("#nocommentNum").show(); else $("#nocommentNum").hide();
        $("#count-seltime-2").text(0).closest("li").hide();
        $("#count-seltime-3").text(0).closest("li").hide()
    } else {
        $("#nocommentNum").parents("li").show();
        $("#count-seltime-2").textS(dataNum2).closest("li").show();
        if (dataNum2 > 0) $("#count-seltime-2").show(); else $("#count-seltime-2").hide();
        $("#count-seltime-3").textS(dataNum3).closest("li").show();
        if (dataNum3 > 0) $("#count-seltime-3").show(); else $("#count-seltime-3").hide();
        $("#nocommentNum").textS(nocommentNum);
        if (nocommentNum > 0) $("#nocommentNum").show(); else $("#nocommentNum").hide()
    }
};
ec.member.orderList.check = function (dom, col) {
    if ($(dom).parent("li").hasClass("current")) return;
    $("#checkid").val(col);
    $(dom).parent("li").addClass("current").siblings().removeClass("current");
    var pamar = {"pageNumber": 1};
    ec.member.orderList.load(pamar, col)
};
ec.member.orderList.renderPage = function (page) {
    if (page.totalPage == 1) {
        $("#list-pager").hide();
        return
    } else $("#list-pager").show();
    $("#list-pager").pager({
        pageNumber: page.pageNumber,
        pageCount: page.totalPage,
        recordCount: page.totalRow,
        qpageSize: 5,
        text: {first: "|\x26lt;", pre: "\x26lt", next: "\x26gt;", last: "\x26gt;|"},
        item: ["first", "pre", "qpage", "next", "last", "quickPager"],
        callBack: ec.member.orderList.load
    });
    $("#list-pager li.link").click(function () {
        $("html,body").scrollTop(0)
    })
};
ec.member.orderList.openLog = function (obj, orderCode) {
    var url = "/member/logisticslog.json", _this = ec.member.orderList, $dialog = $("#interface-dialog-" + orderCode),
        $msg = $("#interface-msg-" + orderCode);
    (new ec.ajax).post({
        url: url,
        data: {"orderCode": orderCode, isHisData: $("#colid").val()},
        timeout: 1E4,
        timeoutFunction: function () {
            $msg.html('\x3cdiv class\x3d"o-logistics-list-loading"\x3e' + timeOutInfo + "\x3c/div\x3e")
        },
        successFunction: function (json) {
            if (!json.success) {
                $msg.html('\x3cdiv class\x3d"o-logistics-list-loading"\x3e\u8d85\u65f6\uff0c\u8bf7\u91cd\u8bd5\uff01\x3c/div\x3e');
                return
            }
            if (null != json.logisticsLogList && json.logisticsLogList.length > 0) $msg.html(ec.member.orderList.interfaceTpl.parse("interface", json.logisticsLogList)); else $msg.html('\x3cdiv class\x3d"o-logistics-list-empty"\x3e\u6682\u65e0\u7269\u6d41\u4fe1\u606f\x3c/div\x3e');
            $(".o-logistics tbody tr:first").addClass("tr-latest")
        }
    })
};
ec.member.orderList.tapcheckAll = function () {
    if ($("#checkAllBox").attr("checked")) {
        $("input[name\x3d'payCheck']").each(function () {
            this.checked = true
        });
        $("#bottomCheckAllBox").prop("checked", true)
    } else {
        $("input[name\x3d'payCheck']").each(function () {
            this.checked = false
        });
        $("#bottomCheckAllBox").prop("checked", false)
    }
};
ec.member.orderList.mergePay = function () {
    var hbc = $("#topButton").attr("class");
    if (hbc == "button-operate-merge-pay") {
        var orderCodes = "";
        var payCheckObj = document.getElementsByName("payCheck");
        var isCheck = ec.member.orderList.checkPayCheck(payCheckObj);
        if (!isCheck) alert("\u8bf7\u9009\u62e9\u8981\u5408\u5e76\u4ed8\u6b3e\u7684\u8ba2\u5355"); else {
            for (var i = 0; i < payCheckObj.length; i++) if (payCheckObj[i].checked) orderCodes += payCheckObj[i].value + "|";
            (new ec.ajax).post({
                url: "/validate/orderClear.json",
                data: {orderList: orderCodes},
                timeout: 1E4,
                timeoutFunction: function () {
                },
                successFunction: function (json) {
                    if (json.success) {
                        $("#clearPay").attr({"action": "/clearPay/order", "method": "post"});
                        $("#clear-Ips").val(JSON.stringify(json.ips));
                        gid("clearPay").submit()
                    } else if (json.code == "login") {
                        ec.account.loginName = "";
                        ec.account.afterLogin(function () {
                            ec.redirectTo(window.location.href)
                        })
                    } else if (json.payNoOne == "unPay") {
                        $("#unPay-inOnce").val('\x3cdiv class\x3d"box-errors-2" id\x3d"tipContent"\x3e\u60a8\u9009\u62e9\u7684\u8ba2\u5355\u7531\u4e0d\u540c\u5546\u5bb6\u53d1\u8d27\u5e76\u63d0\u4f9b\u552e\u540e\u670d\u52a1\uff0c\u6682\u4e0d\u652f\u6301\u5408\u5e76\u652f\u4ed8\uff0c\u8bf7\u5206\u522b\u8fdb\u884c\u652f\u4ed8\u3002\x3c/div\x3e\x3cdiv class\x3d"box-button"\x3e\x3ca href\x3d"javascript:;" class\x3d"box-sure" onclick\x3d"ec.member.orderList.boxCancle()"\x3e\x3cspan\x3e\u786e\u8ba4\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e');
                        ec.member.orderList.unpayTip()
                    } else {
                        $("#unPay-inOnce").val('\x3cdiv class\x3d"box-errors-2" id\x3d"tipContent"\x3e\u975e\u5e38\u62b1\u6b49\uff0c\u8ba2\u5355\u6682\u65f6\u65e0\u6cd5\u652f\u4ed8\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u6216\u8054\u7cfb\u5ba2\u670d\u3002\x3c/div\x3e\x3cdiv class\x3d"box-button"\x3e\x3ca href\x3d"javascript:;" class\x3d"box-sure" onclick\x3d"ec.member.orderList.boxCancle()"\x3e\x3cspan\x3e\u786e\u8ba4\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e');
                        ec.member.orderList.unpayTip()
                    }
                }
            })
        }
    }
};
ec.member.orderList.checkPayCheck = function (obj) {
    var flag = false;
    for (var i = 0; i < obj.length; i++) if (obj[i].checked) {
        flag = true;
        break
    }
    return flag
};
ec.member.orderList.orderCount = function () {
    $.ajax({
        url: domainMain + "/member/orderCount.json?t\x3d" + (new Date).getTime(),
        type: "get",
        async: false,
        timeout: 1E4,
        success: function (json) {
            if (!json.success) return;
            var unPaidTotal = parseInt(json.orderCount.unpaidOrderCount + json.orderCount.partPaidOrderCount);
            if (unPaidTotal != 0) {
                $("#count-seltime-2").show();
                $("#count-seltime-2").textS(unPaidTotal);
                $("#count-seltime-2").attr("data-num", unPaidTotal)
            } else {
                $("#count-seltime-2").hide();
                $("#count-seltime-2").textS(unPaidTotal);
                $("#count-seltime-2").attr("data-num", unPaidTotal)
            }
            $("#count-seltime-3").textS(json.orderCount.unreceiptOrderCount ? json.orderCount.unreceiptOrderCount : 0);
            $("#count-seltime-3").attr("data-num", json.orderCount.unreceiptOrderCount ? json.orderCount.unreceiptOrderCount : 0)
        }
    })
};
ec.member.orderList.allOrderCount = function () {
    $.ajax({
        url: openApiDomain + "/rms/comment/getNoCommentPrdCount.json?t\x3d" + (new Date).getTime(),
        type: "POST",
        dataType: "json",
        data: JSON.stringify({"tab": "nocomment", dateType: "1"}),
        timeout: 1E4,
        beforeSend: function (xhr) {
            xhr.withCredentials = true
        },
        success: function (json) {
            var countSeltime5 = parseInt($("#count-seltime-2-wechat").html()) + parseInt($("#count-seltime-3-wechat").html());
            if (countSeltime5 > 0) {
                $("#li-order-small span").html("\u5c0f\u7a0b\u5e8f\u8ba2\u5355\x3cem\x3e" + countSeltime5 + "\x3c/em\x3e");
                ec.util.cookie.set("vmallOrderCountWechat", countSeltime5)
            } else {
                $("#li-order-small span").html("\u5c0f\u7a0b\u5e8f\u8ba2\u5355");
                ec.util.cookie.set("vmallOrderCountWechat", 0)
            }
            if (json.resultCode != 0) {
                alert("\u5f88\u62b1\u6b49\uff01\u5f85\u8bc4\u4ef7\u67e5\u8be2\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u65b0\u64cd\u4f5c");
                return
            }
            var countSeltime0, countSeltime1, nocommentNum, hisNotRemarkCount;
            nocommentNum = parseInt(json.data.count ? json.data.count : 0);
            hisNotRemarkCount = 0;
            if (nocommentNum > 0) $("#nocommentNum").textS(nocommentNum).show(); else $("#nocommentNum").text(0).hide();
            $("#nocommentNum").attr("data-num", nocommentNum);
            $("#nocommentNum").attr("data-his", hisNotRemarkCount);
            countSeltime1 = hisNotRemarkCount;
            if (countSeltime1 > 0) $("#count-seltime-1").textS(countSeltime1).show(); else $("#count-seltime-1").text(0).hide();
            countSeltime0 = parseInt(json.data.count ? json.data.count : 0) + parseInt($("#count-seltime-2").html()) + parseInt($("#count-seltime-3").html());
            if (countSeltime0 > 0) $("#count-seltime-0").textS(countSeltime0).show(); else $("#count-seltime-0").text(0).hide();
            var allCount = countSeltime0 + countSeltime1;
            if (allCount > 0) {
                $("#li-order span").html("\u6211\u7684\u8ba2\u5355\x3cem\x3e" + allCount + "\x3c/em\x3e");
                ec.util.cookie.set("vmallOrderCount", allCount)
            } else {
                $("#li-order span").html("\u6211\u7684\u8ba2\u5355");
                ec.util.cookie.set("vmallOrderCount", 0)
            }
            $("#ec-tab").navMove({boxClass: "ec-tab-arrow"})
        }
    })
};
ec.member.orderList.urlStatus = function () {
    var nowUrl = window.location.href;
    if (nowUrl.search(/unpaid/) != -1) {
        $("#list-group").html("");
        var obj = $("#myOrder-cate li").eq(1).find("a");
        ec.member.orderList.check(obj, "unpaid")
    } else if (nowUrl.search(/nocomment/) != -1) {
        $("#list-group").html("");
        var obj = $("#myOrder-cate li").eq(2).find("a");
        ec.member.orderList.check(obj, "nocomment")
    } else if (nowUrl.search(/send/) != -1) {
        $("#list-group").html("");
        var obj = $("#myOrder-cate li").eq(3).find("a");
        ec.member.orderList.check(obj, "send")
    }
};
ec.member.orderList.payClick = function () {
    $("input[name\x3d'payCheck']").bind("click", function () {
        var selectNum = 0;
        $("input[name\x3d'payCheck']").each(function (index) {
            if (this.checked) selectNum++
        });
        if (selectNum == $("input[name\x3d'payCheck']").length && $("input[name\x3d'payCheck']").length > 1) {
            $("#checkAllBox").prop("checked", true);
            $("#bottomCheckAllBox").prop("checked", true)
        } else {
            $("#checkAllBox").prop("checked", false);
            $("#bottomCheckAllBox").prop("checked", false)
        }
    })
};
ec.ready(function () {
    if (ec.isIE6) $(".o-logistics").hover(function () {
        $(this).addClass("hover")
    }, function () {
        $(this).removeClass("hover")
    });
    $("#ec-tab").navMove({boxClass: "ec-tab-arrow"});
    ec.member.orderList.urlStatus();
    $("#checkAllBox").click(function () {
        if (this.checked) {
            $("input[name\x3d'payCheck']").each(function (index) {
                this.checked = true
            });
            $("#bottomCheckAllBox").prop("checked", true)
        } else {
            $("input[name\x3d'payCheck']").each(function () {
                this.checked = false
            });
            $("#bottomCheckAllBox").prop("checked", false)
        }
    });
    $("#bottomCheckAllBox").click(function () {
        if (this.checked) {
            $("input[name\x3d'payCheck']").each(function () {
                this.checked = true
            });
            $("#checkAllBox").prop("checked", true)
        } else $("input[name\x3d'payCheck']").each(function () {
            this.checked = false
        })
    });
    ec.member.orderList.allOrderCount();
    ec.member.orderList.GetDateDiff = function (startDate) {
        var startTime = startDate;
        var endTime = (new Date).getTime();
        var dates = parseInt(Math.abs(startTime - endTime) / (1E3 * 60 * 60 * 24));
        return dates
    };
    if (ec.member.orderList.payCheckCount < 2) {
        if (!$("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").addClass("hide");
        if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
    } else {
        if ($("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").removeClass("hide");
        if ($("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").removeClass("hide")
    }
});
$(function () {
    $("#cancelOption li").live("click", function () {
        $(this).children("input").attr("checked", "checked");
        $("#selectReson").html($("input[name\x3d'resonType']:checked")[0].nextSibling.nodeValue);
        $("#cancelReson").val($("input[name\x3d'resonType']:checked").val());
        $("#selectReson").addClass("click");
        $("#cancelErrorMessage").hide();
        $(".order-cancel").find(".order-cancel-pulldown").css({"border": "1px solid #d6d6d6"})
    });
    $("#okButton").live("click", function () {
        if ($("#cancelReson").val() == "") {
            $("#cancelErrorMessage").show();
            $(".order-cancel").find(".order-cancel-pulldown").css({"border": "1px solid #ca141d"});
            return
        }
        _del();
        ec.member.orderList.box.close()
    });
    $("#cancelButton").live("click", function () {
        ec.member.orderList.box.close()
    });
    if ($("input[name\x3d'payCheck']").length == 0 || $("input[name\x3d'payCheck']").length == 1) {
        if (!$("#myOrder-control-bottom").hasClass("hide")) $("#myOrder-control-bottom").addClass("hide");
        if (!$("#myOrder-control-bottom-up").hasClass("hide")) $("#myOrder-control-bottom-up").addClass("hide")
    }
    $("input[name\x3d'payCheck']").bind("click", function () {
        var selectNum = 0;
        $("input[name\x3d'payCheck']").each(function (index) {
            if (this.checked) selectNum++
        });
        if (selectNum == $("input[name\x3d'payCheck']").length && $("input[name\x3d'payCheck']").length > 1) {
            $("#checkAllBox").prop("checked", true);
            $("#bottomCheckAllBox").prop("checked", true)
        } else {
            $("#checkAllBox").prop("checked", false);
            $("#bottomCheckAllBox").prop("checked", false)
        }
    })
});

function pushProMsg(skuId, key) {
    ec.dapClick(key, {"SKUID": skuId, "click": "1"})
}

ec.member.orderList.boxCancle = function (type) {
    $("#ol_box").remove();
    $(".ol_box_mask").remove()
};
ec.member.orderList.remind = function (orderCode, orderType, logisticsName, logisticsNumbers, shippingDate) {
    var msg = "";
    if (orderType == 3) if (shippingDate == "" || shippingDate == "undefined" || shippingDate == "null") msg = "\u60a8\u7684\u8ba2\u5355\u6b63\u5728\u7b49\u5f85\u5546\u54c1\u51fa\u5e93\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"; else msg = "\u60a8\u7684\u8ba2\u5355\u6b63\u5728\u7b49\u5f85\u5546\u54c1\u51fa\u5e93\uff0c\u9884\u8ba1\u53d1\u8d27\u65f6\u95f4\u4e3a" + shippingDate + "\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"; else if (orderType == 5 || orderType == 9) msg = "\u60a8\u7684\u5546\u54c1\u6b63\u5728\u51fa\u5e93\u6253\u5305\u4e2d\uff0c\u5373\u5c06\u53d1\u8d27\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"; else if (logisticsName != "" && logisticsNumbers != "" && logisticsName != "undefined" && logisticsNumbers != "undefined" && logisticsName != "null" && logisticsNumbers != "null") msg = "\u60a8\u7684\u8ba2\u5355\u5df2\u7ecf\u4ea4\u7531" + logisticsName + "\u8fdb\u884c\u914d\u9001\uff0c\u8fd0\u5355\u53f7\u4e3a" + logisticsNumbers + "\uff0c\u8bf7\u4fdd\u6301\u624b\u673a\u7545\u901a\uff0c\u7b49\u5f85\u914d\u9001\u5458\u4e0e\u60a8\u8054\u7cfb\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002"; else msg = "\u60a8\u7684\u8ba2\u5355\u5df2\u53d1\u8d27\uff0c\u8bf7\u4fdd\u6301\u624b\u673a\u7545\u901a\uff0c\u7b49\u5f85\u914d\u9001\u5458\u4e0e\u60a8\u8054\u7cfb\u3002\u50ac\u5355\u7533\u8bf7\u5df2\u6536\u5230\uff0c\u611f\u8c22\u60a8\u5bf9\u5546\u57ce\u7684\u652f\u6301\u3002";
    var msginfo = '\x3cdiv class\x3d"box-title-1"\x3e\u50ac\u5355\u7533\u8bf7\u5df2\u63d0\u4ea4\x3c/div\x3e\x3cdiv class\x3d"hr-15"\x3e\x3c/div\x3e\x3cdiv class\x3d"box-words"\x3e';
    msginfo += "\x3cp\x3e" + msg + "\x3c/p\x3e";
    msginfo += '\x3c/div\x3e \x3cdiv class\x3d"hr-20"\x3e\x3c/div\x3e\x3cdiv class\x3d"box-button"\x3e\x3ca href\x3d"javascript:;" class\x3d"box-ok"\x3e\x3cspan\x3e\u786e\u5b9a\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e';
    ec.member.orderList.remindBox(msginfo, orderCode)
};
var orderCodeInfoTemp = "";
ec.member.orderList.lookSelfExtractingCode = function (orderCodeInfo) {
    orderCodeInfoTemp = orderCodeInfo;
    (new ec.ajax).get({
        url: "/account/queryAccountInfo.json",
        timeout: 1E4,
        timeoutFunction: function () {
            $("#validate-errMsg").html(msgStartTag + timeOutInfo + msgEndTag)
        },
        beforeSendFunction: ec.ui.loading.show,
        afterSendFunction: ec.ui.loading.hide,
        successFunction: function (json) {
            if (json != null && json != undefined && !json.success) {
                var errorHtmlFtl = [];
                errorHtmlFtl.push('\x3cdiv class\x3d"box-prompt01-error"\x3e');
                errorHtmlFtl.push('\t\x3cdiv class\x3d"b"\x3e');
                errorHtmlFtl.push('\t\t\x3cp class\x3d"title"\x3e- \u5e10\u53f7\u4fe1\u606f\u4e0d\u5b8c\u6574 -\x3c/p\x3e');
                errorHtmlFtl.push('\t\t\x3cp\x3e\u4e3a\u4e86\u60a8\u7684\u8d2d\u7269\u5b89\u5168\uff0c\u8bf7\u5148\u7ed1\u5b9a\u624b\u673a\u53f7\u540e\u518d\u8fdb\u884c\u9a8c\u8bc1\u548c\u4fee\u6539\u3002\u7ed1\u5b9a\u6210\u529f\u540e\uff0c\u9700\u8981\x3cspan class\x3d"red"\x3e\u91cd\u65b0\u767b\u5f55\x3c/span\x3e\u624d\u4f1a\u751f\u6548\u54e6\u3002\x3c/p\x3e');
                errorHtmlFtl.push("\t\x3c/div\x3e");
                errorHtmlFtl.push("\x3c/div\x3e");
                errorHtmlFtl.push('\x3cdiv class\x3d"box-button"\x3e');
                errorHtmlFtl.push('\t\x3ca href\x3d"javascript:void;" class\x3d"box-cancel"\x3e\x3cspan\x3e\u53d6\u6d88\x3c/span\x3e\x3c/a\x3e');
                errorHtmlFtl.push('\t\x3ca href\x3d"' + accountCenterUrl + '" target\x3d"_blank" class\x3d"box-ok" id\x3d"unsuccess-view-href"\x3e\x3cspan\x3e\u53bb\u7ed1\u5b9a\x3c/span\x3e\x3c/a\x3e');
                errorHtmlFtl.push("\x3c/div\x3e");
                var box = (new ec.box(errorHtmlFtl.join(""), {
                    boxid: "order-edit-validate-error",
                    boxclass: "ol_box_4",
                    width: 500,
                    showButton: false,
                    onopen: function (box) {
                        box.setPosition()
                    },
                    onclose: function (box) {
                    }
                })).open();
                $("#unsuccess-view-href").click(function () {
                    box.close()
                });
                return
            }
            validateBox = (new ec.box($("#validateTypeBox").val(), {
                boxid: "order-edit-validate",
                boxclass: "ol_box_4",
                title: "\u9700\u8981\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd",
                width: 700,
                showButton: false,
                onopen: function (box) {
                    var $validateType = $("#validateType");
                    var accountInfo = json.customerInfo;
                    var htmlFtl = [];
                    $("#addresseePhoneID").valS(json.addresseePhone);
                    htmlFtl.push('\x3cselect name\x3d"validateType" id\x3d"validateAccountType"\x3e');
                    $.each(accountInfo, function (index, item) {
                        if (item.accountType != undefined && item.account != undefined) htmlFtl.push('\x3coption value\x3d"' + item.accountType + '"\x3e' + item.account + "\x3c/option\x3e")
                    });
                    htmlFtl.push("\x3c/select\x3e");
                    $validateType.append(htmlFtl.join(""));
                    if (ec.member.orderList.time == 60) isInLastTimer = 0;
                    $("#validateCode").bind("keyup", function () {
                        if ($.trim($(this).val()) != "") $("#confirmValidateCode").addClass("box-button-style-2").removeClass("box-button-disabled-style-2"); else $("#confirmValidateCode").addClass("box-button-disabled-style-2").removeClass("box-button-style-2")
                    });
                    box.setPosition()
                },
                onclose: function (box) {
                    if (ec.member.orderList.time == 60) isInLastTimer = 0
                }
            })).open();
            if (isInLastTimer == 1) {
                $("#sendValidateCode").html(ec.member.orderList.time + "\u79d2");
                $("#sendValidateCode").addClass("box-button-disabled-style-1").addClass("red").removeClass("box-button-style-2");
                $("#confirmValidateCode").addClass("box-button-disabled-style-2").removeClass("box-button-style-2");
                $("#confirmValidateCode").addClass("box-button-style-2").removeClass("box-button-disabled-style-2")
            } else $("#confirmValidateCode").addClass("box-button-disabled-style-2").removeClass("box-button-style-2");
            ec.member.orderList.validateBind();
            return
        }
    })
};
ec.member.orderList.validateBind = function () {
    $("#sendValidateCode").click(function () {
        ec.member.orderList.queryValidateCode($(this))
    });
    $("#confirmValidateCode").unbind("click").unbind("keypress");
    $("#confirmValidateCode").click(function () {
        ec.member.orderList.validateCode()
    });
    $("#cancelValidate,#closeValidateBox").click(function () {
        $("#validateTypeBox").hide()
    });
    $("#validateAccountType").change(function () {
        $("#validate-errMsg").html("")
    })
};
ec.member.orderList.time = 60;
ec.member.orderList.queryValidateCode = function ($obj) {
    if (!$obj.hasClass("box-button-style-2")) return;
    if ($.trim($("#validateAccountType").val()) == "") {
        $("#validate-errMsg").html(msgStartTag + "\u8bf7\u9009\u62e9\u83b7\u53d6\u9a8c\u8bc1\u65b9\u5f0f\uff01" + msgEndTag);
        return
    }
    $("#validate-errMsg").html("");
    $obj.addClass("box-button-disabled-style-1").removeClass("box-button-style-2");
    var timer = setInterval(function () {
        isInLastTimer = 1;
        var $sendValidateCode = $("#sendValidateCode");
        ec.member.orderList.time--;
        $obj.addClass("red");
        $sendValidateCode.html(ec.member.orderList.time + "\u79d2");
        if (ec.member.orderList.time == 0) {
            ec.member.orderList.time = 60;
            $sendValidateCode.html("\u518d\u6b21\u53d1\u9001").removeClass("box-button-disabled-style-1").removeClass("red").addClass("box-button-style-2");
            clearInterval(timer)
        }
    }, 1E3);
    isInLastTimer = 0;
    $("#confirmValidateCode").addClass("box-button-style-2").removeClass("box-button-disabled-style-2");
    (new ec.ajax).post({
        url: "/account/queryValidateCode.json",
        data: {"type": $("#validateAccountType").val(), "addresseePhone": $("#addresseePhoneID").val()},
        timeout: 1E4,
        timeoutFunction: function () {
            $("#validate-errMsg").html(msgStartTag + timeOutInfo + msgEndTag)
        },
        beforeSendFunction: ec.ui.loading.show,
        afterSendFunction: ec.ui.loading.hide,
        successFunction: function (json) {
            if (!json.success) {
                ec.showError(json);
                return
            }
            var result = json.rsp;
            if (result != null && result != undefined && result.resultCode != 1) {
                $("#validate-errMsg").html(msgStartTag + result.msg + msgEndTag);
                return
            }
            return
        }
    });
    return false
};
ec.member.orderList.validateCode = function () {
    if (!$("#confirmValidateCode").hasClass("box-button-style-2")) return;
    var validateCode = $("#validateCode").val();
    var accountType = $("#validateAccountType").val();
    if ($.trim(validateCode) == "") {
        $("#validate-errMsg").html(msgStartTag + "\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801" + msgEndTag);
        return
    }
    (new ec.ajax).submit({
        url: "/account/validateCode.json",
        data: {
            "type": $("#validateAccountType").val(),
            "code": validateCode,
            "actionFlag": "",
            "orderCode": orderCodeInfoTemp,
            "isHisData": ""
        },
        timeout: 1E4,
        timeoutFunction: function () {
            $("#validate-errMsg").html(msgStartTag + timeOutInfo + msgEndTag)
        },
        beforeSendFunction: ec.ui.loading.show,
        afterSendFunction: ec.ui.loading.hide,
        successFunction: function (json) {
            if (!json.success) {
                if (json.msg != undefined && json.msg != "") $("#validate-errMsg").html(msgStartTag + json.msg + msgEndTag); else ec.showError(json);
                return
            }
            var result = json.rsp;
            if (result != null && result != undefined && result.resultCode == 0) {
                $("#validate-errMsg").html(msgStartTag + result.msg + msgEndTag);
                return
            }
            (new ec.ajax).post({
                url: "/member/queryOrderSelfPickCode.json?t\x3d" + (new Date).getTime(),
                data: {"orderCode": orderCodeInfoTemp},
                dataType: "json",
                timeout: 1E4,
                timeoutFunction: function () {
                    // alert(timeOutInfo)
                },
                successFunction: function (jsonInfo) {
                    if (jsonInfo.success) {
                        var box = (new ec.box($("#selfPickCodeIDD").val(), {
                            boxid: "selfPickCodeIDD",
                            boxclass: "ol_box_4",
                            title: "\u67e5\u770b\u81ea\u63d0\u7801",
                            showTitle: true,
                            showButton: false
                        })).open();
                        $("#selfPickCodeInfoIDD").textS(jsonInfo.selfPickCode)
                    } else alert("\u67e5\u8be2\u81ea\u63d0\u7801\u5f02\u5e38")
                }
            });
            validateBox.close();
            return
        }
    });
    return false
};