ec.pkg("ec.member.concern");ec.load("ajax",{loadType:"lazy"});ec.member.concern.pageNumber=1;ec.member.concern.recordCount=1;ec.member.concern.load=function(a){$.ajax({url:"/member/notification.json",type:"get",dataType:"json",data:{pageNumber:a.pageNumber,pageCount:a.pageCount,recordCount:a.recordCount,pageSize:a.pageSize},timeout:10000,error:function(){alert("读取超时，请重试！")},success:function(e){if(!e.success){ec.showError(e);return}var d=[],g;var b=false;for(var c=0;c<e.notificationInfoList.length;c++){g=e.notificationInfoList[c];if(g.productId){if(g.virtualQuantity==undefined){g.virtualQuantity=0}b=(g.salesQuantity+g.virtualQuantity>0);d.push('<div class="list-group-item"><div class="o-pro"><table border="0" cellpadding="0" cellspacing="0"><tbody>');d.push('<tr><td class="col-pro-img"><p class="p-img">');d.push('<a href="/product/'+g.productId+".html#"+g.skuId+'" title="'+g.skuName+'" target="_blank">');d.push('<img src="'+ec.mediaPath+g.photoPath+"100_100_"+g.photoName+'" alt="'+g.skuName+'" />');d.push('</a></p></td><td class="col-pro-info"><p class="p-name">');d.push('<a href="/product/'+g.productId+".html#"+g.skuId+'" title="'+g.skuName+'" target="_blank">');d.push(g.skuName);d.push('</a></p></td><td class="col-price"><em>&yen;</em><span>');d.push((g.price||0).toFixed(2));d.push('</span></td><td class="col-state">');if(b){d.push("已到货")}else{if(!b&&g.status=="0"){d.push("已经售罄")}else{if(!b&&g.status=="1"){d.push("即将到货")}}}d.push('</td><td class="col-operate">');if(b){d.push('<p class="p-button"><a class="button-operate-buy" href="/product/'+g.productId+".html#"+g.skuId+'" title="立即购买">');d.push("<span>立即购买</span></a></p>")}d.push('<p class="p-button"><a class="button-operate-unfollow" href="javascript:;" onclick="ec.member.concern.cencal(this,'+ec.encodeForJS(g.id)+')" title="取消关注">');d.push("<span>取消关注</span></a></p>");d.push("</td></tr></tbody></table></div></div>")}}if(e.page.totalPage<e.page.pageNumber){var f={pageNumber:e.page.totalPage};ec.member.concern.load(f);return}if(e.page.totalRow==0){$("#list-group").html('<div class="list-group-empty">您暂时没有相关记录。</div>')}else{$("#list-group").html(d.join(""))}ec.member.concern.renderPage(e.page);ec.ui.scrollTo("#list-group-title")}})};ec.member.concern.skuList=function(c){var b=[];if(c!=null&&c.length>0){for(var a=0;a<c.length;a+=1){b.push("<em>"+c[a]+"</em>")}}return b.join("")};ec.member.concern.renderPage=function(a){if(a.totalPage<=1){$("#list-pager").hide();return}else{$("#list-pager").show()}ec.member.concern.pageNumber=a.pageNumber;$("#list-pager").pager({pageNumber:a.pageNumber,pageCount:a.totalPage,pageSize:10,text:{first:"|&lt;",pre:"&lt",next:"&gt;",last:"&gt;|"},item:["first","pre","qpage","next","last","quickPager"],callBack:ec.member.concern.load})};ec.member.concern.cencal=function(a,b){if(!ec.ui.confirm(a,"您确认要取消该商品吗？")){return}$.ajax({url:"/member/notification/delete.json",type:"POST",data:{nids:b},dataType:"json",timeout:10000,beforeSend:function(c){ec.ui.loading.show;c.withCredentials=true},success:function(c){ec.ui.loading.hide();if(!c.success){ec.showError(c);return}var d={pageNumber:ec.member.concern.pageNumber};ec.member.concern.load(d)},error:function(){alert("读取超时，请重试！")}})};ec.ready(function(){$("#li-notification").addClass("current");$("#pathTitle").html("到货通知")});