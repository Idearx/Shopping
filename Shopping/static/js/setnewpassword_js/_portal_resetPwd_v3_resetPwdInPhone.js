function Trim(e){return e.replace(/(^\s*)|(\s*$)/g,"")}function changeRandomCode(){gid("randomCodeImg")&&(gid("randomCodeImg").src=randomCodeImgURL+"&_t="+(new Date).getTime())}function getMobileCode(e,r,o,t,s,n,a,i,c){var d,l;d=Trim(c||$("#phoneaccount").val()),l=Trim(i||$("#username").val());var p=$("#getValiCode"),u=$("#randomCode").val();if(""==u)return changeRandomCode(),void $("#randomCode").focus();if(p.attr("IntervalTime",60),""==u)return changeRandomCode(),void $("#randomCode").focus();p.attr("IntervalTime",60);var m={70001105:rss_new.uc_error_10000001,70001401:rss_new.uc_error_10000001,70002001:rss_new.uc_error_10000001,70001201:rss_new.uc_error_10000001},_={userAccount:l,smsReqType:r,reqClientType:t,accountType:e,languageCode:localInfo.lang,mobilePhone:d,languageCode:localInfo.lang,operType:a};p.attr("disabled",!0),casAjaxObj.getSMSAuthCode(_,function h(){isMobile()?($("#errorTips").html(""),$("#errorTips").removeClass("addbtmpad-msg-top2p"),$("#codeInputDiv").removeClass("input-error-EMUI5"),wapToast(rss_new.uc_common_sms_has_sendto.format(getExpressPhone(_.mobilePhone)))):showMsgSuccess({obj:$("#msg_getAuthCode"),msg:rss_new.uc_common_sms_has_sendto.format(getExpressPhone(_.mobilePhone)),leftPix:"-239px",rightPix:"-239px",bottom:"39px"});p.attr("IntervalTime",60),p.addClass("auth_code_grey"),p.attr("disabled",!0),jsInnerTimeout()},function C(e){$("#errorTips").addClass("addbtmpad-msg-top2p"),$("#codeInputDiv").addClass("input-error-EMUI5"),p.removeAttr("disabled"),changeRandomCode(),$("#randomCode").val(""),$("#randomCode").focus(),showGetAuthCodeErrorForOld(e)},m)}function showGetAuthCodeErrorForOld(e){$("#errorTips").html(e)}function sendMobileCode(o){var e=o.userAccount,r=o.accountType,t=o.mobilephone,s=o.smsReqType,n=o.reqClientType,a=o.languageCode,i=o.operType,c=o.getCodeButton,d=$("#errorTips"),l={userAccount:e,smsReqType:s,reqClientType:n,accountType:r,languageCode:a,mobilePhone:t,operType:i};c.attr("disabled",!0);var p="getSMSAuthCode";function u(){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:p,actionIsSuccess:1}),o.successFunction&&o.successFunction(),c.attr("IntervalTime",60),c.addClass("auth_code_grey"),c.attr("disabled",!0),jsInnerTimeout()}function m(e,r){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:p,actionIsSuccess:0,actionErrorCode:r.errorCode}),c.removeAttr("disabled"),o.errorBorder&&o.errorBorder.addClass("input-error-EMUI5"),o.errorClass?d.addClass(o.errorClass).html(e):d.html(e)}2==localInfo.verifyAccountType||6==localInfo.verifyAccountType?(l.operType=25,l.loginChannel=localInfo.loginChannel,p="getSMSCodeV3",casAjaxObj.getSMSCodeV3(l,u,m)):casAjaxObj.getSMSAuthCode(l,u,m)}function sendEmailCode(o){var t=o.getCodeButton,s=o.errorTips,e={70001101:rss_new.uc_error_10000001,70001201:rss_new.uc_error_10000001,10000002:rss_new.uc_error_10000001,"default":rss_new.uc_error_10000001},r={email:o.email,userAccount:o.userAccount,accountType:o.accountType,emailReqType:o.emailReqType,languageCode:o.languageCode,reqClientType:o.reqClientType,operType:o.operType};t.attr("disabled",!0),casAjaxObj.getEMailAuthCode(r,function n(){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:"getEMailAuthCode",actionIsSuccess:1}),o.successFunction&&o.successFunction();t.attr("IntervalTime",60),t.attr("disabled",!0),t.addClass("auth_code_grey"),jsInnerTimeout()},function a(e,r){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_GET_AUTHCODE_RESULT",actionName:"getEMailAuthCode",actionIsSuccess:0,actionErrorCode:r.errorCode}),t.removeAttr("disabled"),o.errorBorder&&o.errorBorder.addClass("input-error-EMUI5");o.errorClass?s.addClass(o.errorClass).html(e):s.html(e)},e)}function chkAuthCode(o){var t=o.errorTips,e={accountType:o.accountType,userAccount:o.userAccount,authCode:o.authCode,authOprType:o.authOprType,reqClientType:o.reqClientType,operType:o.operType};casAjaxObj.chkAuthCode(e,function r(e){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkAuthCode",actionIsSuccess:1,message:e.analysisMessage,nextStepUrl:e.nextStepUrl}),o.successFunction&&o.successFunction(e)},function s(e,r){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkAuthCode",actionIsSuccess:0,actionErrorCode:r.errorCode,message:o.accountType}),o.errorBorder&&o.errorBorder.addClass("input-error-EMUI5");o.errorClass?t.addClass(o.errorClass).html(e):t.html(e)})}function pcToast(e,r){var o=countLength(r=xssFilter(r),"font-size:13px;padding:0 12px"),t="font-size:13px;text-align:center;background-color:rgba(209,209,209,0.9);border-radius: 16px;min-width: 76px;margin:0 auto;max-width: 236px;width:"+o+"px;";t+=260<o?"padding:6px 12px;":"padding:0 12px;height:32px;line-height:32px;";var s="toast"+(new Date).getTime(),n="<div  id='"+s+"'>"+r+"</div>";if(0<$("#toastContent").length)0<$("#toastContent div").length&&(n="<div  id='"+s+"'>"+r+"</div>"),$("#toastContent").append(n),$("#toastContent").find("#"+s).attr("style",t+"margin-top:10px");else{e.append("<div id='toastContent' style='position:absolute;top:64px;width:100%;z-index:100000'></div>"),$("#toastContent").append(n),$("#toastContent").find("#"+s).attr("style",t)}setTimeout(function(){$("#"+s).remove()},2e3)}function countLength(e,r){e=xssFilter(e.trim());var o="count"+(new Date).getTime();r+=";visibility:hidden;word-wrap:break-word;word-break:break-all;";var t="<span id='"+o+"'>"+e+"</span>";$("body").append(t),$("body").find("#"+o).attr("style",r);var s=$("#"+o)[0].offsetWidth;return $("#"+o).remove(),s}function jsInnerTimeout(){var e=$("#getValiCode"),r=parseInt(e.attr("IntervalTime"));if(r--,e.attr("disabled",!0),r<=-1)return e.removeAttr("disabled"),e.removeClass("auth_code_grey"),isMobile()&&(e.attr("type")&&"button"==e.attr("type").toLowerCase()?e.val(rss_new.common_Resend):e.find("span,a").text(rss_new.common_Resend)),e.val(rss_new.common_Resend),e.find("span:first,a:first").text(rss_new.common_Resend),e.attr("IntervalTime",60),!0;isMobile()?e.attr("type")&&"button"==e.attr("type").toLowerCase()?e.val(rss_new.common_Resend_time.format(r)):e.find("span,a").text(rss_new.common_Resend_time.format(r)):(e.val(rss_new.common_Resend_time.format(r)),e.find("span:first,a:first").text(rss_new.common_Resend_time.format(r))),e.attr("IntervalTime",r),setTimeout("jsInnerTimeout()",1e3)}function isMobile(){for(var e=navigator.userAgent,r=["Android","iPhone","SymbianOS","Mobile","Windows Phone","iPad","iPod"],o=!1,t=0;t<r.length;t++)if(0<e.indexOf(r[t])){o=!0;break}return o}function getTwoFacRecovery(e,r){ajaxHandler("getTwoFacRecovery",{},function(e){e.accountRecoverState;var r=e.errorCode;return"1"==e.isSuccess?(localInfo.clientNonce?gotoUrl(e.nextStepUrl+localInfo.urlQurey+"&sceneID=1&clientNonce="+localInfo.clientNonce+"&extInfo="+e.extInfo):gotoUrl(e.nextStepUrl+localInfo.urlQurey+"&sceneID=1&extInfo="+e.extInfo),!0):("10000001"==r?$("#error-tips").html(rss_new.uc_error_10000001):"10000004"==r?$("#error-tips").html(rss_new.uc_error_10000004):"10000002"==r?$("#error-tips").html(rss_new.uc_error_10000002):"10000003"==r?$("#error-tips").html(rss_new.uc_error_10000003):"10001003"==r?showUsernameError(rss_new.uc_error_10001003):"10001004"==r?showUsernameError(rss_new.uc_error_10000004):"70001401"==e.errorCode?$("#error-tips").html(rss_new.uc_error_70001401):$("#error-tips").html(rss_new.resetpwd_accountinfo_not_exist),!1)})}function showErrorNew(e,r,o){e?(e.addClass("input-error-EMUI5"),r.html(o).addClass("error-tips-EMUI5")):r.html(o).addClass("errorColor")}function hideErrorNew(e,r){e.removeClass("input-error-EMUI5"),r.html("").removeClass("error-tips-EMUI5")}function hideErrorBox(e){e.removeClass("input-error-EMUI5")}function showPopError(e){showSystemError(e,rss_new.box_js_confirm)}function chkReRegister(t){var s=t.errorTips,e={accountType:t.accountType,userAccount:t.userAccount,authCode:t.authCode,authOprType:t.authOprType,reqClientType:t.reqClientType,lang:localInfo.lang,operType:t.operType};casAjaxObj.chkReRegister(e,function r(e){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkReRegister",actionIsSuccess:1,message:e.analysisMessage,nextStepUrl:e.nextStepUrl}),"762"!=localInfo.reqClientType&&"true"==localInfo.isSameAsInput&&e&&1==e.reRegisterFlag&&e.siteInfoList&&0<e.siteInfoList.length?popIsNewFromOld(e.siteInfoList[0],e.regExtInfo,t.successFunction,e):t.successFunction&&t.successFunction(e)},function n(e,r){var o='{"verifyAccountType":'+t.accountType+"}";analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_CLICK_NEXT_RESULT",actionName:"chkReRegister",actionIsSuccess:0,actionErrorCode:r.errorCode,message:o}),t.errorBorder&&t.errorBorder.addClass("input-error-EMUI5");t.errorClass?s.addClass(t.errorClass).html(e):s.html(e)})}function popIsNewFromOld(e,r,o,t){e=e||{};var s=localInfo.verifyUserAccount,n={userAccount:s,userAvatar:e.avatar,userNickName:e.nickName||"",userPhoneNum:s};$("<div/>").Dialog({title:rss_new.reg_again_title,titleUnderline:!1,btnRight:{text:rss_new.login_bind_pwd_contine,fn:function(){analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_TWICE_CONTINUE"}),o(t)}},cancelFn:function(){this.hide()},btnLeft:{text:rss_new.login_bind_pwd_cancel,fn:function(){window.webLoader?(analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_TWICE_REG",message:"1"}),window.webLoader.intoApp("ok")):(analysisHealth({operType:20,event:"FORGOT_INPUTAUTHCODE_TWICE_REG",message:"2",nextStepUrl:localInfo.registerLink+"&fregExtInfo="+r}),gotoUrl(localInfo.registerLink+"&fregExtInfo="+r))}},html:'<div class="normal-color reg-user-desc">'+rss_new.reg_again_content.format(n.userAccount)+'</div><div class="marginTop8 center reg-user-info"><div class="reg-avatar '+(n.userAvatar?"avatarCircle":"")+'"><img src="'+(n.userAvatar||localInfo.defaultAvatar)+'" alt="" onerror="this.src = localInfo.defaultAvatar;this.onerror = null;"/></div><div class="marginTop8 normal-color medium">'+n.userNickName+'</div><p class="marginTop8 font-desc" style="margin-bottom: 36px;"><span class="nophonewrap userAccount">'+n.userPhoneNum+"</span></p></div>"}).Dialog("show")}function submitFun(e){var r=$("#newPassword").val(),o=$("#reqClientType").val(),t=$("#forget_msg"),s={reqClientType:o,languageCode:localInfo.lang,newPassword:r,keepOtherDevLogon:e,recoverySuccess:localInfo.recoverySuccess,trustedDevice:localInfo.trustedDevice,isVerifyDeviceSecure:localInfo.isVerifyDeviceSecure,isRecoveryAuthCode:localInfo.isRecoveryAuthCode};casAjaxObj.resetPwdBySecPhoneEmail(s,function(e){t.show().html(""),e.hasEmergencyContract?gotoUrl(localHttps+"/portal/resetPwd/forgetPhoneSuccess.html"+localInfo.urlQurey):gotoUrl(localHttps+"/portal/resetPwd/setContact.html"+localInfo.urlQurey)},function(e,r){$("#errorTips").addClass("addbtmpad-msg-top2p");var o=r.errorCode;"10000601"==o?($("#errorTips").html(e),setTimeout(function(){gotoUrl(localHttps+"/portal/resetPwd/forgetbyid.html")},2e3)):"70008001"==o||"70009016"==o?($("#passwd_msg").addClass("addbtmpad-msg-top2p"),$("#passwd_msg").html(e),$("#passwordDiv").addClass("input-error-EMUI5")):"70002039"==o?showSystemError(e,rss_new.common_ok,function(){location.href=localInfo.findPwd}):$("#errorTips").html(e)})}$.label($("#newPassword"),rss_new.placeholder_password),$.label($("#confirmPasswd"),rss_new.common_confirmPassword),$("#pwdLength span").html($("#pwdLength span").html().format(8,32)),$("#pwdNumber span").html($("#pwdNumber span").html().format(1)),$(function(){$("#passwdEye,#confirmPasswordEye").click(function(){var e=$(this).attr("id"),r="";"passwdEye"==e?r=document.getElementById("newPassword"):"confirmPasswordEye"==e&&(r=document.getElementById("confirmPasswd")),"password"==r.type?(r.type="text",$(this).attr("src",XSSGuard4URL(localInfo.eyeon))):(r.type="password",$(this).attr("src",XSSGuard4URL(localInfo.eyeoff)))}),$("#confirmPasswd,#newPassword").bind("copy",function(e){e.preventDefault()});var e=$("#resetPwdBtn");$("#authCode").validator("bind",{type:["require","length"],validOnChange:!1,trim:!0,max:8,min:4,errorFunction:function(e,r){switch($("#errorTips").addClass("addbtmpad-msg-top2p"),r.type){case"require":$("#errorTips").html(rss_new.common_js_inputcode);break;case"length":$("#errorTips").html(rss_new.common_js_wrongcode)}},successFunction:function(e,r){$("#msg_randomCode").show().html(""),$("#errorTips").html(""),$("#errorTips").removeClass("addbtmpad-msg-top2p")}});var r=$("#newPassword"),o=$("#confirmPasswd");r.validator("bind",{type:["require","strLength","hasSpace","pwdComplexity","errorInput"],trim:!1,validOnChange:!0,max:32,min:8,errorFunction:function(e,r){switch($("#passwd_msg").addClass("addbtmpad-msg-top2p"),$("#passwordDiv").addClass("input-error-EMUI5"),r.type){case"require":$("#passwd_msg").html(rss_new.common_js_inputpwd);break;case"strLength":$("#passwd_msg").html(rss_new.reducePwd_format_2);break;case"hasSpace":$("#passwd_msg").html(rss_new.reducePwd_format_1);break;case"pwdComplexity":$("#passwd_msg").html(rss_new.reducePwd_format_3);break;case"errorInput":$("#passwd_msg").html(rss_new.reducePwd_inputError_desc)}},successFunction:function(e,r){$("#passwordDiv").removeClass("input-error-EMUI5"),$("#passwd_msg").removeClass("addbtmpad-msg-top2p"),$("#passwd_msg").html("")},reInputFunction:function(){$("#passwordDiv").removeClass("input-error-EMUI5"),$("#passwd_msg").html(""),$("#passwd_msg").removeClass("addbtmpad-msg-top2p"),o.val()&&validator(o,!0)}}),o.validator("bind",{type:["require","eq"],trim:!1,validOnChange:!0,compareTo:r,max:32,min:8,errorFunction:function(e,r){switch(r.type){case"require":$("#errorTips").addClass("addbtmpad-msg-top2p"),$("#errorTips").html(rss_new.common_js_inputpwd),$("#confirmPasswordDiv").addClass("input-error-EMUI5");break;case"eq":$("#errorTips").addClass("addbtmpad-msg-top2p"),$("#confirmPasswordDiv").addClass("input-error-EMUI5"),$("#errorTips").html(rss_new.common_js_pwdnotsame)}},successFunction:function(e,r){$("#confirmPasswordDiv").removeClass("input-error-EMUI5"),$("#errorTips").removeClass("addbtmpad-msg-top2p"),$("#errorTips").html("")},reInputFunction:function(){$("#errorTips").html(""),$("#errorTips").removeClass("addbtmpad-msg-top2p"),$("#confirmPasswordDiv").removeClass("input-error-EMUI5")}}),e.bind("click",function(){if($(this).hasClass("disabled"))return!1;var e=$(".form-edit-area")[0];if(!validator(e,!0))return!1;showSTdialog(0,submitFun)}),$(".input-scroll").focus(function(){var r=$(this).offset().top;setTimeout(function(){var e=document.body.clientHeight;document.documentElement.clientHeight<e?$("body").css("position","relative"):$("body").css("position","static"),window.scrollTo(0,r)},200)}),r.bind("keyup",function(){onPwdKeyUp4EMUI(r[0],$("#passwd_msg"),$("#passwordDiv"),"","input-error-EMUI5",!0,"",!0)}),registerPwdformatValidator4Wap()});